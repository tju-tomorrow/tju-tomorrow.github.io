<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>My First Post</title>
    <url>/2024/07/25/2024-07-25-the-First-One-2024/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Hey"><a href="#Hey" class="headerlink" title="Hey"></a>Hey</h2><blockquote>
<p>&#x8FD9;&#x662F;&#x6211;&#x7684;&#x7B2C;&#x4E00;&#x7BC7;&#x535A;&#x5BA2;&#x3002;</p>
</blockquote>
<h3 id="preface"><a href="#preface" class="headerlink" title="preface"></a>preface</h3><p>In the first blog I want to talk about methods of primitives.We know objects have methods and in javascript we have the power to treat them as they were objects.</p>
<span id="more"></span>

<h3 id="first-why-we-want-to-treat-primitives-like-objects"><a href="#first-why-we-want-to-treat-primitives-like-objects" class="headerlink" title="first why we want to treat primitives like objects"></a>first why we want to treat primitives like objects</h3><p>There are many things one would want to do with a primitive, like a string or a number. It would be great to access them using methods.</p>
<hr>

<p>We should know the respective specialities of primitive and object before we want to combine the speciality in object(have methods) into the mechanism of primitive</p>
<h3 id="the-distinctions-between-primitive-and-object"><a href="#the-distinctions-between-primitive-and-object" class="headerlink" title="the distinctions between primitive and object"></a>the distinctions between primitive and object</h3><h4 id="primitive"><a href="#primitive" class="headerlink" title="primitive"></a>primitive</h4><p>is a value of the basic type <code>string</code>, <code>number</code>, <code>bigint</code>, <code>boolean</code>, <code>symbol</code>, <code>null</code> and <code>undefined</code>.<br>So it&#x2019;s light-weight.</p>
<h4 id="object"><a href="#object" class="headerlink" title="object"></a>object</h4><p>object is capable to store mutiple values as their &#x201C;properties&#x201D;</p>
<p>there is a <strong>superiority</strong> of object that is : we can insert or store a function into a property</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> object = {</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;jack&quot;</span>,</span><br><span class="line">  <span class="attr">sayhi</span>: <span class="keyword">function</span> (<span class="params"></span>) {</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">  },</span><br><span class="line">};</span><br></pre></td></tr></table></figure>

<h4 id="So-Objects-are-&#x201C;heavier&#x201D;-than-primitives-They-require-additional-resources-to-support-the-internal-machinery"><a href="#So-Objects-are-&#x201C;heavier&#x201D;-than-primitives-They-require-additional-resources-to-support-the-internal-machinery" class="headerlink" title="So Objects are &#x201C;heavier&#x201D; than primitives. They require additional resources to support the internal machinery."></a>So Objects are &#x201C;heavier&#x201D; than primitives. They require additional resources to support the internal machinery.</h4><p>Then we manage to add the speciality into primitive which is being able to use &#x201C;.&#x201D; to invoke some methods.</p>
<h3 id="How-to-accomplish-that-treat-primitives-like-objects"><a href="#How-to-accomplish-that-treat-primitives-like-objects" class="headerlink" title="How to accomplish that : treat primitives like objects"></a>How to accomplish that : treat primitives like objects</h3><p>With the speciality added,</p>
<p>we also want to keep primitives lightweight In the meantime.</p>
<p>So here we think :Only When we want to operate primitives with methods they are objects And When we don&#x2019;t need that they change back to primitive (So that they can provide methods, but they still remain lightweight)<br>So flexible!</p>
<p>In order to do that :<strong>a special &#x201C;object wrapper&#x201D; that provides the extra functionality is created, and then is destroyed.</strong></p>
<h4 id="Dive-in"><a href="#Dive-in" class="headerlink" title="Dive in"></a>Dive in</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let str = &quot;Hello&quot;;</span><br><span class="line"></span><br><span class="line">alert( str.toUpperCase() ); // HELLO</span><br></pre></td></tr></table></figure>

<ol>
<li>The string <code>str</code> is a primitive. So in the moment of accessing its property, a special object is created that <strong>knows the value of the string</strong>, and has useful methods, like <code>toUpperCase()</code>.</li>
<li>That method runs and returns a new string (shown by <code>alert</code>).</li>
<li>The special object is destroyed, leaving the primitive <code>str</code> alone.</li>
</ol>
<p>Which means something besides the simple and standalone value is actually created!</p>
<h4 id="Some-details-to-supplementary"><a href="#Some-details-to-supplementary" class="headerlink" title="Some details to supplementary"></a>Some details to supplementary</h4><ol>
<li><p><strong>null/undefined have no methods</strong><br>In a sense, they are &#x201C;the most primitive&#x201D;.</p>
</li>
<li><p>using the same functions <code>String/Number/Boolean</code> without <code>new</code> is totally fine and useful thing. They convert a value to the corresponding type: to a string, a number, or a boolean (primitive).</p>
<p>For example, this is entirely valid:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="title class_">Number</span>(<span class="string">&quot;123&quot;</span>); <span class="comment">// convert a string to number</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Still !! <strong>primitives are not objects.</strong> which means they can&#x2019;t store additional data</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let str = &quot;Hello&quot;;</span><br><span class="line"></span><br><span class="line">str.test = 5;</span><br><span class="line"></span><br><span class="line">alert(str.test);</span><br></pre></td></tr></table></figure>

<p>the result will be</p>
<ol>
<li><code>undefined</code> (no strict mode)</li>
<li>An error (strict mode).</li>
</ol>
<p>The reason is that &#x201C;wrapper object&#x201D; :<br>when you use &#x201C;.&#x201D; after &#x201C;str&#x201D; (in other words when you wanna access the &#x201C;str&#x201D;) the &#x201C;wrapper object&#x201D; is created.</p>
<ol>
<li>in &#x201C;no strict mode&#x201D; it carries the &#x201C;test&#x201D; property but remember it will disappear When you see the &#x201C;;&#x201D; after&#x201D;5;&#x201D; it disappears. So you won&#x2019;t have the trace of the &#x201C;wrapper object&#x201D; .It vanishes with no trace. So you could only get &#x201C;undefined&#x201D;</li>
<li>in &#x201C;strict mode&#x201D; : there is a red flag or a Rule that cannot be crossed : you can&#x2019;t write into &#x201C;wrapper object&#x201D; So An error</li>
</ol>
]]></content>
      <categories>
        <category>Front-end</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>data types</tag>
        <tag>数据类型</tag>
      </tags>
  </entry>
  <entry>
    <title>Promise</title>
    <url>/2024/07/27/2024-07-27-Promise-2024/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><h2 id="Preface-Scene-Imagination-lead-to-Promise"><a href="#Preface-Scene-Imagination-lead-to-Promise" class="headerlink" title="Preface:Scene Imagination lead to Promise"></a>Preface:Scene Imagination lead to Promise</h2><blockquote>
<p>Imagine that you&#x2019;re a top singer, and fans ask day and night for your upcoming song.</p>
</blockquote>
<span id="more"></span>

<blockquote>
<p>To get some relief, you promise to send it to them when it&#x2019;s published. You give your fans a list. They can fill in their email addresses, so that when the song becomes available, all subscribed parties instantly receive it. And even if something goes very wrong, say, a fire in the studio, so that you can&#x2019;t publish the song, they will still be notified.</p>
</blockquote>
<p>For the first sight:1.What?Promise is made by the singer and<br>2.Why?it&#x2019;s produced because the result can&#x2019;t be immediate.<br>3.Efficacy?And promise connects singer and prospective subcribers. and makes it possible for the existence of delay.So it&#x2019;s actually for dealing tasks that requires <strong>time</strong>.</p>
<p>And To map to concepts about Promise :</p>
<ol>
<li>&#x201C;A producing code&#x201D; is the singer. It can&#x2019;t immediately give program-flow or another-code a result so that program-flow can proceed So it make a <em>promise</em> .<br>What may be the &#x201C;producing code&#x201D; :For instance, some code that loads the data over a network and that takes <strong>time</strong></li>
<li>A &#x201C;consuming code&#x201D;(another-code that mentioned above) that wants the result of the &#x201C;producing code&#x201D; once it&#x2019;s ready(for inputing paramters or something else) .These are the &#x201C;fans&#x201D;.</li>
<li><strong>A <em>promise</em> is a special JavaScript</strong> object that links the &#x201C;producing code&#x201D; and the &#x201C;consuming code&#x201D; together. In terms of our analogy: this is the &#x201C;subscription list&#x201D;. The &#x201C;producing code&#x201D; takes whatever time it needs to produce the promised result, and the &#x201C;promise&#x201D; makes that result available to all of the subscribed code when it&#x2019;s ready.</li>
</ol>
<h2 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h2><p>The constructor syntax for a promise object is:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) {</span><br><span class="line">  <span class="comment">// executor (the producing code, &quot;singer&quot;)</span></span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<p>To explain:</p>
<ol>
<li><p>The function passed to <code>new Promise</code> is called the <em>executor</em>.</p>
<p>When <code>new Promise</code> is created, the executor runs <strong>automatically</strong>(this is a func don&#x2019;t need to be called by&#x201D;()&#x201D;). It contains the producing code which should eventually produce the result. In terms of the analogy above: the executor is the &#x201C;singer&#x201D;.</p>
</li>
<li><p>Its arguments <code>resolve</code> and <code>reject</code> are callbacks provided by JavaScript itself.</p>
</li>
<li><p>When the executor obtains the result, be it soon or late, doesn&#x2019;t matter,it should call one of these callbacks:</p>
<ul>
<li><p><code>resolve(value)</code> &#x2014; if the job is finished successfully, with result <code>value</code>.</p>
</li>
<li><p><code>reject(error)</code> &#x2014; if an error has occurred, <code>error</code> is a Error object.<br>To supplementay:</p>
<blockquote>
<p>[!CAUTION]</p>
<p>The executor receives two arguments: <code>resolve</code> and <code>reject</code>. These functions are pre-defined by the JavaScript engine, so we don&#x2019;t need to create them. We should only call one of them when ready.<br>the executor may calls <code>resolve(&quot;done&quot;)</code> to produce the <strong>result</strong>(remember above we said the executor should eventually produce the result? Yeah it can be done by calling resolve)</p>
</blockquote>
</li>
</ul>
</li>
<li><p>So to summarize: the executor runs automatically and attempts to perform a job. When it is finished with the attempt, it calls <code>resolve</code> if it was successful or <code>reject</code> if there was an error.</p>
<blockquote>
<p>[!Important]</p>
<p>1.So Promise constructor requires a function that contains two built-in callbacks as paramter And the function is <em>the</em> executor<br>2.executor carries two callback that is ready to be called and then produces the <strong>result</strong><br>3.result exists relating to two possible state<br>4.what is eventually returned by this syntax constructor is actually a object which is the Promise. And result is just been carried with.</p>
</blockquote>
</li>
</ol>
<hr>

<p>To proceed:</p>
<p><strong>The <code>promise</code> object returned</strong> by the <code>new Promise</code> constructor has these internal properties:</p>
<ul>
<li><code>state</code> &#x2014; initially <code>&quot;pending&quot;</code>, then changes to either <code>&quot;fulfilled&quot;</code> when <code>resolve</code> is called or <code>&quot;rejected&quot;</code> when <code>reject</code> is called.</li>
<li><code>result</code> &#x2014; initially <code>undefined</code>, then changes to <code>value</code> when <code>resolve(value)</code> is called or <code>error</code> when <code>reject(error)</code> is called.</li>
</ul>
<p>So the executor eventually moves <code>promise</code> to one of these states:<img src="/2024/07/27/2024-07-27-Promise-2024/07/27/2024-07-27-Promise-2024/GitHub%20download/typora/%E6%96%87%E4%BB%B6%E9%9B%86%E5%90%88/Blogs/Promise/Promise.assets/image-20240727013201754.png" alt="image-20240727013201754"></p>
<p>and if we successfully produce the result which the consuming codes are craving for. It turned like this:<img src="/2024/07/27/2024-07-27-Promise-2024/07/27/2024-07-27-Promise-2024/GitHub%20download/typora/%E6%96%87%E4%BB%B6%E9%9B%86%E5%90%88/Blogs/Promise/Promise.assets/image-20240727014147939.png" alt="image-20240727014147939"></p>
<p>A promise that is either fulfilled or rejected is called &#x201C;settled&#x201D;, as opposed to an initially &#x201C;pending&#x201D; promise.</p>
<h2 id="To-be-noted-fundamental"><a href="#To-be-noted-fundamental" class="headerlink" title="To be noted (fundamental)"></a>To be noted (fundamental)</h2><ol>
<li><strong>There can be only a single result or an error</strong></li>
</ol>
<p>The executor should call only one <code>resolve</code> or one <code>reject</code>. <strong>Any state change is final.</strong></p>
<p>All further calls of <code>resolve</code> and <code>reject</code> are ignored:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) {</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;done&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;&#x2026;&quot;</span>)); <span class="comment">// ignored</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;&#x2026;&quot;</span>)); <span class="comment">// ignored</span></span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<p>Also, <code>resolve</code>/<code>reject</code> expect only one argument <strong>(or none)</strong> and will ignore additional arguments.</p>
<ol start="2">
<li><p><strong>A good habit:Reject with</strong> <code>Error</code> <strong>objects</strong></p>
<p>In case something goes wrong, the executor should call <code>reject</code>. That can be done with any type of argument (just like <code>resolve</code>). But it is recommended to use <code>Error</code> objects (or objects that inherit from <code>Error</code>)<br>To explain: <code>reject(new Errror(&apos;wrong&apos;))</code> is better than <code>reject(&apos;wrong&apos;)</code></p>
</li>
<li><blockquote>
<p>[!NOTE]</p>
<p><strong>The</strong> <code>state</code> <strong>and</strong> <code>result</code> <strong>are internal</strong></p>
</blockquote>
<p>Which means :<code>state</code> and <code>result</code> of the Promise object can&#x2019;t be directly accessed.Accessing has to be done bymethods <code>.then</code>/<code>.catch</code>/<code>.finally</code> &#xFF08;They are described below.&#xFF09;</p>
</li>
</ol>
<h2 id="Consumers-then-catch"><a href="#Consumers-then-catch" class="headerlink" title="Consumers:then catch"></a>Consumers:then catch</h2><p>As you might have comprehensed by now: A Promise object <strong>serves as a link</strong> between the executor (the &#x201C;producing code&#x201D; or &#x201C;singer&#x201D;) and the consuming functions (the &#x201C;fans&#x201D;) which will receive the result or error.It actually bond these two togther <strong>by something.</strong></p>
<p>Something(mentioned above) is methods <code>.then</code> and <code>.catch</code>.</p>
<h3 id="then"><a href="#then" class="headerlink" title="then"></a>then</h3><p>The syntax is:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">promise.<span class="title function_">then</span>(</span><br><span class="line">  <span class="keyword">function</span> (<span class="params">result</span>) {</span><br><span class="line">    <span class="comment">/* handle a successful result */</span></span><br><span class="line">  },</span><br><span class="line">  <span class="keyword">function</span> (<span class="params">error</span>) {</span><br><span class="line">    <span class="comment">/* handle an error */</span></span><br><span class="line">  }</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>See? The promise comes from a producing code (executor)<br>(In case you forget):</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) {</span><br><span class="line">  <span class="comment">// executor (the producing code, &quot;singer&quot;)</span></span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<p>And it serves as a link And it uses then/catch methods to connect with the consuming functions (that desperate to receive a result or a error)<br>You can see the consuming functions as the one above</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params">result</span>) { <span class="comment">/* handle a successful result */</span> },</span><br><span class="line"><span class="keyword">function</span>(<span class="params">error</span>) { <span class="comment">/* handle an error */</span> }</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!NOTE]</p>
<p>the then methods <strong>could</strong> specify two functions:1.one for the success result 2. one for the rejected error</p>
</blockquote>
<blockquote>
<p>[!TIP]</p>
<p>If we&#x2019;re interested to see successful completions(what&#x2019;s in resolve)<br>we can provide only one function argument to <code>.then</code>:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> {</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;done!&quot;</span>), <span class="number">1000</span>);</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(alert); <span class="comment">// shows &quot;done!&quot; after 1 second</span></span><br></pre></td></tr></table></figure>

<p>because in then handler <strong>promise.result</strong> is passed as paramter</p>
</blockquote>
<h3 id="catch"><a href="#catch" class="headerlink" title="catch"></a>catch</h3><p>catch only for error</p>
<p>If we&#x2019;re interested only in errors, then we can use <code>null</code> as the first argument: <code>.then(null, errorHandlingFunction)</code>. Or we can use <code>.catch(errorHandlingFunction)</code>, which is exactly the same:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Whoops!&quot;</span>)), <span class="number">1000</span>);</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="comment">// .catch(f) is the same as promise.then(null, f)</span></span><br><span class="line">promise.<span class="title function_">catch</span>(alert); <span class="comment">// shows &quot;Error: Whoops!&quot; after 1 second</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!CAUTION]</p>
<p>The call <code>.catch(f)</code> is a complete analog of <code>.then(null, f)</code>, it&#x2019;s just a shorthand.</p>
</blockquote>
<h2 id="finally"><a href="#finally" class="headerlink" title="finally"></a>finally</h2><p>The call <code>.finally(f)</code> is similar to <code>.then(f, f)</code> in the sense that <code>f</code> runs always, when the promise is settled: be it resolve or reject.</p>
<h3 id="Why-need-finally"><a href="#Why-need-finally" class="headerlink" title="Why need finally"></a>Why need finally</h3><p>The idea of <code>finally</code> is to set up a handler for performing cleanup/finalizing after the previous operations are complete.<br><code>finally</code> &#x7684;&#x60F3;&#x6CD5;&#x662F;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF0C;&#x7528;&#x4E8E;&#x5728;&#x524D;&#x9762;&#x7684;&#x64CD;&#x4F5C;&#x5B8C;&#x6210;&#x540E;&#x6267;&#x884C;&#x6E05;&#x7406;/&#x7EC8;&#x7ED3;&#x3002;<br>Because in real-life code after promise is produced,something should be close or clean up.</p>
<blockquote>
<p>[!NOTE]</p>
<p>a handler is function in promise-chain but a object in Proxy(,handler) Its translation in Chinese is &#x201C;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x201D;</p>
</blockquote>
<p>E.g. stopping loading indicators, closing no longer needed connections, etc.</p>
<p>Think of it as a party finisher. No matter was a party good or bad, how many friends were in it, we still need (or at least should) do a cleanup after it.</p>
<h3 id="syntax"><a href="#syntax" class="headerlink" title="syntax"></a>syntax</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">  <span class="comment">/* do something that takes time, and then call resolve or maybe reject */</span></span><br><span class="line">})</span><br><span class="line">  <span class="comment">// runs when the promise is settled, doesn&apos;t matter successfully or not</span></span><br><span class="line">  .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> stop loading indicator)</span><br><span class="line">  <span class="comment">// so the loading indicator is always stopped before we go on</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> show result, <span class="function"><span class="params">err</span> =&gt;</span> show error)</span><br></pre></td></tr></table></figure>

<h3 id="Differences-between-finally-f-and-then-f-f"><a href="#Differences-between-finally-f-and-then-f-f" class="headerlink" title="Differences between finally(f) and then(f,f)"></a>Differences between finally(f) and then(f,f)</h3><ol>
<li><p>A <code>finally</code> handler has no arguments.</p>
<blockquote>
<p>[!NOTE]</p>
<p>In <code>finally</code> we don&#x2019;t know and we shouldn&#x2019;t know whether the promise is successful or not.</p>
</blockquote>
<p>That&#x2019;s all right, as our task is usually to perform &#x201C;general&#x201D; <strong>finalizing</strong> procedures.(=producing promise procedure cause when you created the state-change is <strong>final</strong>)</p>
<p>take a look at the example above: as you can see, the <code>finally</code> handler has no arguments, and the promise outcome is handled by the next handler.</p>
</li>
<li><p>A <code>finally</code> handler <strong>&#x201C;passes through&#x201D;</strong> the result or error to the next suitable handler.</p>
<p>For instance, here the result is passed through <code>finally</code> to <code>then</code>:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;value&quot;</span>), <span class="number">2000</span>);</span><br><span class="line">})</span><br><span class="line">  .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> <span class="title function_">alert</span>(<span class="string">&quot;Promise ready&quot;</span>)) <span class="comment">// triggers first</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="title function_">alert</span>(result)); <span class="comment">// &lt;-- .then shows &quot;value&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><blockquote>
<p>[!IMPORTANT]</p>
<p>That&#x2019;s very convenient, because <code>finally</code> is <strong>not meant to</strong> process a promise result (the treasure produced). As said, it&#x2019;s a place to do generic cleanup, no matter what the outcome was.</p>
</blockquote>
</li>
<li><p>A <code>finally</code> handler also shouldn&#x2019;t return anything. If it does, the returned value is silently ignored.</p>
<blockquote>
<p>[!WARNING]</p>
<p>The only exception to this rule is when a <code>finally</code> handler throws an error. Then this error goes to the next handler, instead of any previous outcome.</p>
</blockquote>
</li>
</ol>
<blockquote>
<p>[!IMPORTANT]</p>
<p>Sum up finally :<br>finally is <strong>just</strong> a dutiful cleaner lady.<br>Only pass promise.result and clean<br>don&#x2019;t receive (paramter) don&#x2019;t return don&#x2019;t know (what&#x2019;s going on about promise)<br>it runs regardlessly and ensures that a piece of code executes no matter what the outcome of the promise is.<br>But If cleaning-machine malfunctions throw a Error</p>
</blockquote>
<blockquote>
<p>[!TIP]</p>
<h2 id="handlers"><a href="#handlers" class="headerlink" title="handlers"></a>handlers</h2><p>To supplementary: finally and then-catch (which means all handlers)all operate on Promise object<br>And The premise that they run is Promise object which just produced,or you can say the state of Promise object is settled<br>In below&#x2019;s case they run immediately</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// the promise becomes resolved immediately upon creation</span></span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;done!&quot;</span>));</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(alert); <span class="comment">// done! (shows up right now)</span></span><br></pre></td></tr></table></figure>

<p>Note that this makes promises more powerful than the real life &#x201C;subscription list&#x201D; scenario. If the singer has already released their song before a person signs up on the subscription list, they probably won&#x2019;t receive that song. Subscriptions in real life must be done prior to the event.<br>&#x8BA2;&#x9605;&#x53D1;&#x751F;&#x5728;&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#x4E4B;&#x524D;</p>
</blockquote>
<blockquote>
<p>[!IMPORTANT]</p>
<p>Sum up handler:<br>1.operate on Promise object<br>2.when &#x201C;.handler&#x201D; &#x2018;s front is a promise fully formed,handler runs immediately</p>
</blockquote>
<h2 id="eg1-loadScript"><a href="#eg1-loadScript" class="headerlink" title="eg1:loadScript"></a>eg1:loadScript</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadScript</span>(<span class="params">src, callback</span>) {</span><br><span class="line">  <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">  script.<span class="property">src</span> = src;</span><br><span class="line"></span><br><span class="line">  script.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">callback</span>(<span class="literal">null</span>, script); <span class="comment">//The moment when script loads successfully the callback runs</span></span><br><span class="line">  script.<span class="property">onerror</span> = <span class="function">() =&gt;</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Script load error for <span class="subst">${src}</span>`</span>)); <span class="comment">//The moment when script loads fail</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">append</span>(script);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!NOTE]</p>
<ol>
<li>the onload and onerror methods of A script element (Actually HTML-Element is built-in object) implies what will happen when script loads successfully or fail</li>
<li>To put callback directly in this position(right after &#x201C;()=&gt;&#x201D;) doesn&#x2019;t invoke the callback immediately; it just assigns it as the handler for the event.So when the event occurs callback is invoked automatically</li>
</ol>
</blockquote>
<p>Let&#x2019;s rewrite it using Promises.</p>
<p>The new function <code>loadScript</code> will not require a callback. Instead, it will create and return a Promise object that resolves when the loading is complete. The outer code can add handlers (subscribing functions) to it using <code>.then</code>:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadScript</span>(<span class="params">src</span>) {</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) {</span><br><span class="line">    <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">    script.<span class="property">src</span> = src;</span><br><span class="line"></span><br><span class="line">    script.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>(script);</span><br><span class="line">    script.<span class="property">onerror</span> = <span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Script load error for <span class="subst">${src}</span>`</span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">append</span>(script);</span><br><span class="line">  });</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="title function_">loadScript</span>(</span><br><span class="line">  <span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.js&quot;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(</span><br><span class="line">  <span class="function">(<span class="params">script</span>) =&gt;</span> <span class="title function_">alert</span>(<span class="string">`<span class="subst">${script.src}</span> is loaded!`</span>),</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> <span class="title function_">alert</span>(<span class="string">`Error: <span class="subst">${error.message}</span>`</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">(<span class="params">script</span>) =&gt;</span> <span class="title function_">alert</span>(<span class="string">&quot;Another handler...&quot;</span>));</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">Promises</th>
<th align="left">Callbacks</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Promises allow us to do things in the natural order. First, we run <code>loadScript(script)</code>, and <code>.then</code> we write what to do with the result.</td>
<td align="left">We must have a <code>callback</code> function at our disposal when calling <code>loadScript(script, callback)</code>. In other words, we must know what to do with the result <em>before</em> <code>loadScript</code> is called.</td>
</tr>
<tr>
<td align="left">We can call <code>.then</code> on a Promise as many times as we want. Each time, we&#x2019;re adding a new &#x201C;fan&#x201D;, a new subscribing function, to the &#x201C;subscription list&#x201D;.</td>
<td align="left">There can be only one callback.</td>
</tr>
</tbody></table>
<h2 id="eg2-delay-using-promise"><a href="#eg2-delay-using-promise" class="headerlink" title="eg2:delay using promise"></a>eg2:delay using promise</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">delay</span>(<span class="params">ms</span>) {</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="title function_">delay</span>(<span class="number">3000</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="title function_">alert</span>(<span class="string">&quot;runs after 3 seconds&quot;</span>));</span><br></pre></td></tr></table></figure>

<h1 id="To-supplementay"><a href="#To-supplementay" class="headerlink" title="To supplementay"></a>To supplementay</h1><p>For a Promise<br>the state change of a Promise is a one-time thing.<br>And there are only two results:alive or dead<br>fulfilled or rejected</p>
]]></content>
      <categories>
        <category>Front-end</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>Promise</tag>
      </tags>
  </entry>
  <entry>
    <title>Promise chainning</title>
    <url>/2024/07/28/2024-07-28-Promise-chainning-2024/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Promise-chainning"><a href="#Promise-chainning" class="headerlink" title="Promise chainning"></a>Promise chainning</h1><h2 id="what-is-Promise-chainning"><a href="#what-is-Promise-chainning" class="headerlink" title="what is Promise chainning"></a>what is Promise chainning</h2><p>A Promise-chain starts with <code>new Promise</code> constructor and use<code>then/catch</code> as middle-party to pass the <code>promise.result</code></p>
<span id="more"></span>

<p>which is formed like this:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) {</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="number">1</span>), <span class="number">1000</span>); <span class="comment">// (*)</span></span><br><span class="line">})</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">result</span>) {</span><br><span class="line">    <span class="comment">// (**)</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">alert</span>(result); <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">return</span> result * <span class="number">2</span>;</span><br><span class="line">  })</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">result</span>) {</span><br><span class="line">    <span class="comment">// (***)</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">alert</span>(result); <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">return</span> result * <span class="number">2</span>;</span><br><span class="line">  })</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">result</span>) {</span><br><span class="line">    <span class="title function_">alert</span>(result); <span class="comment">// 4</span></span><br><span class="line">    <span class="keyword">return</span> result * <span class="number">2</span>;</span><br><span class="line">  });</span><br></pre></td></tr></table></figure>

<h2 id="why-it&#x2019;s-created"><a href="#why-it&#x2019;s-created" class="headerlink" title="why it&#x2019;s created"></a>why it&#x2019;s created</h2><p>We have a sequence of asynchronous tasks needed to be performed one after another In other words:When dealing with tasks that have sequencial order<br>for instance, loading scripts.<br>we can&#x2019;t hold all tasks in one &#x201C;then&#x201D; handler<br>It&#x2019;s known that When a handler returns a value, it becomes the result of that promise and in this chainning system<br>the promise holding a value peformed by the last handler become the input of next handler</p>
<p>analogy:<br>If you look at this in a broad way<br>you can see Promise keep a emerge-dive pattern like a joyful fish<br>The Promise-wrapper is the same just the inside-value(or result) changes each time emerge-dive</p>
<h2 id="returning-promise"><a href="#returning-promise" class="headerlink" title="returning promise"></a>returning promise</h2><p>A handler, used in <code>.then(handler)</code> may create and return a promise.<br>In that case further handlers <strong>wait</strong> until it settles, and then get its result.</p>
<p>For instance:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) {</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="number">1</span>), <span class="number">1000</span>);</span><br><span class="line">})</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">result</span>) {</span><br><span class="line">    <span class="title function_">alert</span>(result); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">      <span class="comment">// (*)</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">    });</span><br><span class="line">  })</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">result</span>) {</span><br><span class="line">    <span class="comment">// (**)</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">alert</span>(result); <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(result * <span class="number">2</span>), <span class="number">1000</span>);</span><br><span class="line">    });</span><br><span class="line">  })</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">result</span>) {</span><br><span class="line">    <span class="title function_">alert</span>(result); <span class="comment">// 4</span></span><br><span class="line">  });</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!NOTE]</p>
<p>In <code>then</code> handler if you return a value the value become a Promise for the next <code>then</code><br>But returning a Promise seems more reasonable</p>
</blockquote>
<p>So the output is the same as in the previous example: 1 &#x2192; 2 &#x2192; 4, but now with 1 second delay between <code>alert</code> calls.</p>
<h2 id="Here-we-go-Useful-example-loadscript"><a href="#Here-we-go-Useful-example-loadscript" class="headerlink" title="Here we go ! Useful example : loadscript"></a>Here we go ! Useful example : loadscript</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">loadScript</span>(<span class="string">&quot;/article/promise-chaining/one.js&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">script</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">loadScript</span>(<span class="string">&quot;/article/promise-chaining/two.js&quot;</span>);</span><br><span class="line">  })</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">script</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">loadScript</span>(<span class="string">&quot;/article/promise-chaining/three.js&quot;</span>);</span><br><span class="line">  })</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">script</span>) {</span><br><span class="line">    <span class="comment">// use functions declared in scripts</span></span><br><span class="line">    <span class="comment">// to show that they indeed loaded</span></span><br><span class="line">    <span class="title function_">one</span>();</span><br><span class="line">    <span class="title function_">two</span>();</span><br><span class="line">    <span class="title function_">three</span>();</span><br><span class="line">  });</span><br></pre></td></tr></table></figure>

<p>This code can be made bit shorter with arrow functions:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">loadScript</span>(<span class="string">&quot;/article/promise-chaining/one.js&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">script</span>) =&gt;</span> <span class="title function_">loadScript</span>(<span class="string">&quot;/article/promise-chaining/two.js&quot;</span>))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">script</span>) =&gt;</span> <span class="title function_">loadScript</span>(<span class="string">&quot;/article/promise-chaining/three.js&quot;</span>))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">script</span>) =&gt;</span> {</span><br><span class="line">    <span class="comment">// scripts are loaded, we can use functions declared there</span></span><br><span class="line">    <span class="title function_">one</span>();</span><br><span class="line">    <span class="title function_">two</span>();</span><br><span class="line">    <span class="title function_">three</span>();</span><br><span class="line">  });</span><br></pre></td></tr></table></figure>

<h2 id="A-special-feature"><a href="#A-special-feature" class="headerlink" title="A special feature"></a>A special feature</h2><p><strong>This feature will allow us to integrate custom objects with promise chains without having to inherit from Promise</strong><br>What does above mean ? To understand that there should be a clarification:<br><strong>Actually in the promise-chain It&#x2019;s not promise that continuely flow up and down (return and input)(that means what the handler returns is not Promise ) It&#x2019;s another special object called <em>&#x201C;thenable&#x201D; object</em></strong><br>All the things we said above still <strong>valid</strong> because this &#x201C;thenable&#x201D; object has <em>.then</em> method and can be treated like Promise.So actually it gives us flexibilty!Because we can build like an architect on a object that has already implemented with basic Promise-function</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Thenable</span> {</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">num</span>) {</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">num</span> = num;</span><br><span class="line">  }</span><br><span class="line">  <span class="title function_">then</span>(<span class="params">resolve, reject</span>) {</span><br><span class="line">    <span class="title function_">alert</span>(resolve); <span class="comment">// function() { native code }</span></span><br><span class="line">    <span class="comment">// resolve with this.num*2 after the 1 second</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="variable language_">this</span>.<span class="property">num</span> * <span class="number">2</span>), <span class="number">1000</span>); <span class="comment">// (**)</span></span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="title function_">resolve</span>(<span class="number">1</span>))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Thenable</span>(result); <span class="comment">// (*)</span></span><br><span class="line">  })</span><br><span class="line">  .<span class="title function_">then</span>(alert); <span class="comment">// shows 2 after 1000ms</span></span><br></pre></td></tr></table></figure>

<p>JavaScript checks the object returned by the <code>.then</code> handler in line <code>(*)</code>: if it has a callable method named <code>then</code>, then it calls that method providing native functions <code>resolve</code>, <code>reject</code> as arguments (similar to an executor) and waits until one of them is called. In the example above <code>resolve(2)</code> is called after 1 second <code>(**)</code>. Then the result is passed further down the chain.</p>
<blockquote>
<p>[!TIP]</p>
<p>A Thenable class should still define the <code>then</code> method inside<br>And what is passed into the constructor is actually the <code>promise.result</code></p>
</blockquote>
<h2 id="example-associated-with-fetch"><a href="#example-associated-with-fetch" class="headerlink" title="example associated with fetch"></a>example associated with <em>fetch</em></h2><p>We&#x2019;ll use the <a href="https://javascript.info/fetch">fetch</a> method to load the information about the user from the remote server. It has a lot of optional parameters covered in <a href="https://javascript.info/fetch">separate chapters</a>, but the basic syntax is quite simple:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="title function_">fetch</span>(url);</span><br></pre></td></tr></table></figure>

<p>fetch(url) is saying :make a network request to the <code>url</code> and returns a promise. The promise resolves with a <code>response</code> object when the remote server responds with headers, but <em>before the full response is downloaded</em>.</p>
<blockquote>
<p>[!NOTE]</p>
<p>You haven&#x2019;t got the infomation now</p>
</blockquote>
<p>To read the full response, we should call the method <code>response.text()</code>: it returns a promise that resolves when the full text is downloaded from the remote server, with that text(information we require) as a result.</p>
<blockquote>
<p>[!NOTE]</p>
<p>So response is a promise and response.text() is also a promise</p>
</blockquote>
<p>The code below makes a request to <code>user.json</code> and loads its text from the server:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;/article/promise-chaining/user.json&quot;</span>)</span><br><span class="line">  <span class="comment">// .then below runs when the remote server responds</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">response</span>) {</span><br><span class="line">    <span class="comment">// response.text() returns a new promise that resolves with the full response text</span></span><br><span class="line">    <span class="comment">// when it loads</span></span><br><span class="line">    <span class="keyword">return</span> response.<span class="title function_">text</span>();</span><br><span class="line">  })</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">text</span>) {</span><br><span class="line">    <span class="comment">// ...and here&apos;s the content of the remote file</span></span><br><span class="line">    <span class="title function_">alert</span>(text); <span class="comment">// {&quot;name&quot;: &quot;iliakan&quot;, &quot;isAdmin&quot;: true}</span></span><br><span class="line">  });</span><br></pre></td></tr></table></figure>

<p>The <code>response</code> object returned from <code>fetch</code> also includes the method <code>response.json()</code> that reads the remote data and parses it as JSON. In our case that&#x2019;s even more convenient</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// same as above, but response.json() parses the remote content as JSON</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;/article/promise-chaining/user.json&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">user</span>) =&gt;</span> <span class="title function_">alert</span>(user.<span class="property">name</span>)); <span class="comment">// iliakan, got user name</span></span><br></pre></td></tr></table></figure>

<p>let&#x2019;s see a more complex one :</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Make a request for user.json</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;/article/promise-chaining/user.json&quot;</span>)</span><br><span class="line">  <span class="comment">// Load it as json</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  <span class="comment">// Make a request to GitHub</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">user</span>) =&gt;</span> <span class="title function_">fetch</span>(<span class="string">`https://api.github.com/users/<span class="subst">${user.name}</span>`</span>))</span><br><span class="line">  <span class="comment">// Load the response as json</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  <span class="comment">// Show the avatar image (githubUser.avatar_url) for 3 seconds (maybe animate it)</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">githubUser</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">let</span> img = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">    img.<span class="property">src</span> = githubUser.<span class="property">avatar_url</span>;</span><br><span class="line">    img.<span class="property">className</span> = <span class="string">&quot;promise-avatar-example&quot;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">append</span>(img);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> img.<span class="title function_">remove</span>(), <span class="number">3000</span>); <span class="comment">// (*)</span></span><br><span class="line">  });</span><br></pre></td></tr></table></figure>

<p>this works but below is much better :</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;/article/promise-chaining/user.json&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">user</span>) =&gt;</span> <span class="title function_">fetch</span>(<span class="string">`https://api.github.com/users/<span class="subst">${user.name}</span>`</span>))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  .<span class="title function_">then</span>(</span><br><span class="line">    <span class="function">(<span class="params">githubUser</span>) =&gt;</span></span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) {</span><br><span class="line">        <span class="comment">// (*)</span></span><br><span class="line">        <span class="keyword">let</span> img = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">        img.<span class="property">src</span> = githubUser.<span class="property">avatar_url</span>;</span><br><span class="line">        img.<span class="property">className</span> = <span class="string">&quot;promise-avatar-example&quot;</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">append</span>(img);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> {</span><br><span class="line">          img.<span class="title function_">remove</span>();</span><br><span class="line">          <span class="title function_">resolve</span>(githubUser); <span class="comment">// (**)</span></span><br><span class="line">        }, <span class="number">3000</span>);</span><br><span class="line">      })</span><br><span class="line">  )</span><br><span class="line">  <span class="comment">// triggers after 3 seconds</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">githubUser</span>) =&gt;</span> <span class="title function_">alert</span>(<span class="string">`Finished showing <span class="subst">${githubUser.name}</span>`</span>));</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!CAUTION]</p>
<p>As a good practice, an asynchronous action should always return a promise.</p>
</blockquote>
<p>That makes it possible to plan actions after it; even if we don&#x2019;t plan to extend the chain now, we may need it later.</p>
<h2 id="When-should-you-consider-about-Promise"><a href="#When-should-you-consider-about-Promise" class="headerlink" title="When should you consider about Promise"></a>When should you consider about Promise</h2><p>In the last chapter <em>Promise</em> we bury a seed in the last.This is the position it should get settled<br>So promise is actually used in a situation : 1.the task is gonna need some time 2. there are two possible consequences of the task3.mostly have to do with networking connection<br>let us see some egs</p>
<ol>
<li><pre><code class="js">fetch(&quot;https://api.examplecom/data&quot;)
  .then((response) =&gt; response.json())
  .then((data) =&gt; console.log(data))
  .catch((error) =&gt; console.log(error));
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">   fetch is a api that allows us to input a url as a door to get data and this api return a promise</span><br><span class="line">   (of course! 1.Getting is absolutely a task that requires some time2.two consequences : get it or miss it)</span><br><span class="line">   And during each level of the chain promise.result is passed as paramter for handler</span><br><span class="line"></span><br><span class="line">2. ```js</span><br><span class="line">   function LoadImage(url) {</span><br><span class="line">     return new Promise((resolve, reject) =&gt; {</span><br><span class="line">       const img = new Image(); //create a img</span><br><span class="line">       img.src = url;</span><br><span class="line">       img.onload = () =&gt; resolve(img);</span><br><span class="line">       img.onerror = () =&gt; reject(new Error(&quot;fail loading&quot;));</span><br><span class="line">     });</span><br><span class="line">   }</span><br><span class="line">   LoadImage(&quot;path/to/image.jpg&quot;)</span><br><span class="line">     .then((img) =&gt; document.body.appendChild(img))</span><br><span class="line">     .catch((error) =&gt; console.error(error));</span><br></pre></td></tr></table></figure>

Why do you need to bind functionc to events of img?
Cause two callback must be called .And when you wanna use then/catch handler to link the function(LoadImage).It should be a produced (fully formed)promise in front of these handlers
</code></pre>
</li>
<li><p>Custom Promise<br>Promise basically follow this pattern:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>) {</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">if</span> (success) {</span><br><span class="line">      <span class="title function_">resolve</span>(result);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;error&quot;</span>));</span><br><span class="line">    }</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"><span class="title function_">doSomething</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(error));</span><br></pre></td></tr></table></figure>
</li>
<li><p>Ajax with XMLHttpRequest</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ajax</span>(<span class="params">url</span>) {</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, url);</span><br><span class="line">    xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">    xhr.<span class="property">onerror</span> = <span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;ajax failed&quot;</span>));</span><br><span class="line">    xhr.<span class="title function_">send</span>();</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"><span class="title function_">ajax</span>(<span class="string">&quot;https://&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(error));</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>Front-end</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>Promise</tag>
      </tags>
  </entry>
  <entry>
    <title>Proxy</title>
    <url>/2024/08/19/2024-08-19-Proxy-2024/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h1><h2 id="what&#x2019;s-a-proxy"><a href="#what&#x2019;s-a-proxy" class="headerlink" title="what&#x2019;s a proxy"></a>what&#x2019;s a proxy</h2><p>a proxy is a object with a superpower of wrapping another object Like a trash wrapper <br></p>
<span id="more"></span>

<p>Not only wrap it but also protect it . The protecting way is to intercept the operations that are about to operate on the object that been wrapped inside For example reading/writing properties <br><br><strong>optionally handling them on Proxy&#x2019;s own</strong></p>
<h2 id="Proxy-syntax"><a href="#Proxy-syntax" class="headerlink" title="Proxy syntax"></a>Proxy syntax</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let` proxy `=` `new` `Proxy``(`target`,` handler`)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>target</code> &#x2013; is an object to wrap, can be anything, including functions.</li>
<li><code>handler</code> &#x2013; proxy configuration: an object with &#x201C;traps&#x201D;, methods that intercept operations. &#x2013; e.g. <code>get</code> trap for reading a property of <code>target</code>, <code>set</code> trap for writing a property into <code>target</code>, and so on.</li>
</ul>
<p>For operations on <code>proxy</code>, if there&#x2019;s a corresponding trap in <code>handler</code>, then it runs<br>otherwise the operation is performed <strong>directly</strong> on <code>target</code>.</p>
<h3 id="A-proxy-with-no-&#x201C;traps&#x201D;-can-be-seen-as-the-object-inside-itself-OR-without-any-traps-proxy-is-a-transparent-wrapper-around-target"><a href="#A-proxy-with-no-&#x201C;traps&#x201D;-can-be-seen-as-the-object-inside-itself-OR-without-any-traps-proxy-is-a-transparent-wrapper-around-target" class="headerlink" title="A proxy with no &#x201C;traps&#x201D; can be seen as the object(inside) itself OR without any traps, proxy is a transparent wrapper around target"></a>A proxy with no &#x201C;traps&#x201D; can be seen as the object(inside) itself OR without any traps, <code>proxy</code> is a transparent wrapper around <code>target</code></h3><p>Below is the demonstration</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let target = {};</span><br><span class="line">let proxy = new Proxy(target, {});</span><br><span class="line">proxy.test = 5; //set to proxy also set to target</span><br><span class="line">console.log(&quot;target.test is &quot;, target.test);</span><br></pre></td></tr></table></figure>

<p>As there are no traps, all operations on <code>proxy</code> are forwarded to <code>target</code>.</p>
<h3 id="What-can-we-intercept"><a href="#What-can-we-intercept" class="headerlink" title="What can we intercept"></a>What can we intercept</h3><p>For a object there are some so-called &#x201C;internal method&#x201D;<br><code>[[Get]]</code>, the internal method to read a property,<br><code>[[Set]]</code>, the internal method to write a property,</p>
<p><strong>Proxy traps intercept invocations of these methods</strong></p>
<p>They are listed in the <a href="https://tc39.es/ecma262/#sec-proxy-object-internal-methods-and-internal-slots">Proxy specification</a> and in the table below.</p>
<h2 id="Internal-Method-and-handler-methods-and-Trigger-point"><a href="#Internal-Method-and-handler-methods-and-Trigger-point" class="headerlink" title="Internal Method and handler methods and Trigger-point"></a>Internal Method and handler methods and Trigger-point</h2><p><strong>For every internal method, there&#x2019;s a trap in this table: the name of the method that we can add to the <code>handler</code> parameter of <code>new Proxy</code> to intercept the operation</strong></p>
<h4 id="To-note"><a href="#To-note" class="headerlink" title="To note"></a>To note</h4><p>handler is a paramter in Proxy&#x2019;s constructor.It&#x2019;s a set including all the methods(we can call them Handler Methods)<br>And what&#x2019;s actually intercepting the specific operation?THE corresponding handler method!<br>How?When you trigger the internal method in THE object.</p>
<table>
<thead>
<tr>
<th align="left">Internal Method In object &#x5185;&#x90E8;&#x65B9;&#x6CD5;</th>
<th align="left">Handler Method In proxy &#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x65B9;&#x6CD5;</th>
<th align="left">Triggers when&#x2026; &#x89E6;&#x53D1;&#x65F6;&#x2026;</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>[[Get]]</code></td>
<td align="left"><code>get</code></td>
<td align="left">reading a property &#x8BFB;&#x53D6;&#x5C5E;&#x6027; use [ ] or . on a object</td>
</tr>
<tr>
<td align="left"><code>[[Set]]</code></td>
<td align="left"><code>set</code></td>
<td align="left">writing to a property &#x5199;&#x5165;&#x5C5E;&#x6027; .newproperty = /.push(for array) /unshift</td>
</tr>
<tr>
<td align="left"><code>[[HasProperty]]</code></td>
<td align="left"><code>has</code></td>
<td align="left"><code>in</code> operator <code>in</code> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td align="left"><code>[[Delete]]</code></td>
<td align="left"><code>deleteProperty</code></td>
<td align="left"><code>delete</code> operator <code>delete</code> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td align="left"><code>[[Call]]</code></td>
<td align="left"><code>apply</code></td>
<td align="left">function call &#x51FD;&#x6570;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left"><code>[[Construct]]</code></td>
<td align="left"><code>construct</code></td>
<td align="left"><code>new</code> operator <code>new</code> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td align="left"><code>[[GetPrototypeOf]]</code></td>
<td align="left"><code>getPrototypeOf</code></td>
<td align="left"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf">Object.getPrototypeOf &#x5BF9;&#x8C61;.getPrototypeOf</a></td>
</tr>
<tr>
<td align="left"><code>[[SetPrototypeOf]]</code></td>
<td align="left"><code>setPrototypeOf</code></td>
<td align="left"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf">Object.setPrototypeOf &#x5BF9;&#x8C61;.setPrototypeOf</a></td>
</tr>
<tr>
<td align="left"><code>[[IsExtensible]]</code></td>
<td align="left"><code>isExtensible</code></td>
<td align="left"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isExtensible">Object.isExtensible &#x5BF9;&#x8C61;&#x53EF;&#x6269;&#x5C55;</a></td>
</tr>
<tr>
<td align="left"><code>[[PreventExtensions]]</code></td>
<td align="left"><code>preventExtensions</code></td>
<td align="left"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/preventExtensions">Object.preventExtensions &#x5BF9;&#x8C61;.preventExtensions</a></td>
</tr>
<tr>
<td align="left"><code>[[DefineOwnProperty]]</code></td>
<td align="left"><code>defineProperty</code></td>
<td align="left"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">Object.defineProperty</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperties">Object.defineProperties</a> &#x5BF9;&#x8C61;.defineProperty, &#x5BF9;&#x8C61;.defineProperties</td>
</tr>
<tr>
<td align="left"><code>[[GetOwnProperty]]</code></td>
<td align="left"><code>getOwnPropertyDescriptor</code></td>
<td align="left"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor">Object.getOwnPropertyDescriptor</a>, <code>for..in</code>, <code>Object.keys/values/entries</code> Object.getOwnPropertyDescriptor&#xFF0C; <code>for..in</code> &#xFF0C; <code>Object.keys/values/entries</code></td>
</tr>
<tr>
<td align="left"><code>[[OwnPropertyKeys]]</code></td>
<td align="left"><code>ownKeys</code></td>
<td align="left"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames">Object.getOwnPropertyNames</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertySymbols">Object.getOwnPropertySymbols</a>, <code>for..in</code>, <code>Object.keys/values/entries</code> Object.getOwnPropertyNames&#x3001;Object.getOwnPropertySymbols&#x3001; <code>for..in</code> &#x3001; <code>Object.keys/values/entries</code></td>
</tr>
</tbody></table>
<h4 id="Notification"><a href="#Notification" class="headerlink" title="Notification"></a>Notification</h4><ul>
<li><code>[[Set]]</code> must return <code>true</code> if the value was written successfully, otherwise <code>false</code>.</li>
<li><code>[[Delete]]</code> must return <code>true</code> if the value was deleted successfully, otherwise <code>false</code>.</li>
</ul>
<h3 id="How-to-set-the-handler"><a href="#How-to-set-the-handler" class="headerlink" title="How to set the handler"></a>How to set the handler</h3><p>To intercept reading, the <code>handler</code> should have the so-called handler-method <code>get(target, property, receiver)</code> As we mentioned: <strong>It triggers when a property is read</strong></p>
<ul>
<li><code>target</code> &#x2013; is the target object, the one passed as the first argument to <code>new Proxy</code>,</li>
<li><code>property</code> &#x2013; the object&#x2019;s property(the key in a key-value pair),</li>
<li><code>receiver</code> &#x2013; if the target property is a getter, then <code>receiver</code> is the object that&#x2019;s going to be used as <code>this</code> in its call. Usually that&#x2019;s the <code>proxy</code> object itself (or an object that inherits from it, if we inherit from proxy). Right now we don&#x2019;t need this argument, so it will be explained in more detail later.</li>
</ul>
<h4 id="eg1"><a href="#eg1" class="headerlink" title="eg1"></a>eg1</h4><p>Usually when one tries to get a non-existing array item, they get <code>undefined</code>, but we&#x2019;ll wrap a regular array into the proxy that traps reading and returns <code>0</code> if there&#x2019;s no such property:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(number, {</span><br><span class="line">  <span class="title function_">get</span>(<span class="params">target, prop</span>) {</span><br><span class="line">    <span class="keyword">if</span> (prop <span class="keyword">in</span> target) {</span><br><span class="line">      <span class="keyword">return</span> target[prop];</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<p>there should be a supplement For array : if array is seen as a object {key&#xFF1A;value}The &#x6570;&#x7EC4;&#x7684;&#x7D22;&#x5F15; is the key The &#x5177;&#x4F53;&#x6570;&#x503C; &#x662F; value</p>
<h4 id="eg2"><a href="#eg2" class="headerlink" title="eg2"></a>eg2</h4><p>Let&#x2019;s say we want an array exclusively for numbers. If a value of another type is added, there should be an error.</p>
<p><strong>The <code>set</code> trap triggers when a property is written.</strong></p>
<p><code>set(target, property, value, receiver)</code>:</p>
<ul>
<li><code>target</code> &#x2013; is the target object, the one passed as the first argument to <code>new Proxy</code>,</li>
<li><code>property</code> &#x2013; property name,</li>
<li><code>value</code> &#x2013; property value,</li>
<li><code>receiver</code> &#x2013; similar to <code>get</code> trap, matters only for setter properties.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [];</span><br><span class="line"></span><br><span class="line">numbers = <span class="keyword">new</span> <span class="title class_">Proxy</span>(numbers, {</span><br><span class="line">  <span class="comment">// (*)</span></span><br><span class="line">  <span class="title function_">set</span>(<span class="params">target, prop, val</span>) {</span><br><span class="line">    <span class="comment">// to intercept property writing</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> val == <span class="string">&quot;number&quot;</span>) {</span><br><span class="line">      target[prop] = val;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">//For set, it must return true for a successful write.</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">numbers.<span class="title function_">push</span>(<span class="number">1</span>); <span class="comment">// added successfully</span></span><br><span class="line">numbers.<span class="title function_">push</span>(<span class="number">2</span>); <span class="comment">// added successfully</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;Length is: &quot;</span> + numbers.<span class="property">length</span>); <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">numbers.<span class="title function_">push</span>(<span class="string">&quot;test&quot;</span>); <span class="comment">// TypeError (&apos;set&apos; on proxy returned false)</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;This line is never reached (error in the line above)&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>For <code>set</code>, it must return <code>true</code> for a successful write.</strong></p>
<h3 id="Note-Only-interact-with-the-proxy-object"><a href="#Note-Only-interact-with-the-proxy-object" class="headerlink" title="Note : Only interact with the proxy object"></a>Note : Only interact with the proxy object</h3><h4 id="You-should-follow-below"><a href="#You-should-follow-below" class="headerlink" title="You should follow below:"></a>You should follow below:</h4><p>When a proxy object is created <strong>As for</strong> when you have proxied an object<br>You shouldn&#x2019;t reference the origin(or target) object.(the object is past the moment you get the proxy version)<br>And below is a normal way we deal with it.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dictionary = new Proxy(dictionary, ...);</span><br></pre></td></tr></table></figure>

<p>can overwrite the &#x201C;dictionary&#x201D; variable .</p>
<h4 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h4><p>Usually When you created a proxy You got to devise some traps . And so it&#x2019;s important for you to make sure the defined behaviors and traps are constantly applied to ensure all operation go through the proxy and its traps</p>
<h2 id="iteration"><a href="#iteration" class="headerlink" title="iteration"></a>iteration</h2><h3 id="OwnPropertyKeys-internal-method"><a href="#OwnPropertyKeys-internal-method" class="headerlink" title="[[OwnPropertyKeys]] internal method"></a><code>[[OwnPropertyKeys]]</code> internal method</h3><p><code>Object.keys</code>, <code>for..in</code> loop and most other methods that iterate over object properties (use <code>[[OwnPropertyKeys]]</code> internal method) (intercepted by <code>ownKeys</code> trap) to** get a list of properties**</p>
<h4 id="Such-methods-differ-in-details"><a href="#Such-methods-differ-in-details" class="headerlink" title="Such methods differ in details:"></a>Such methods differ in details:</h4><ul>
<li><code>Object.getOwnPropertyNames(obj)</code> returns non-symbol keys.</li>
<li><code>Object.getOwnPropertySymbols(obj)</code> returns symbol keys.</li>
<li><code>Object.keys/values()</code> returns non-symbol keys/values with <code>enumerable</code> flag (property flags were explained in the article <a href="https://javascript.info/property-descriptors">Property flags and descriptors</a>).</li>
<li><code>for..in</code> loops over non-symbol keys with <code>enumerable</code> flag, and also prototype keys.</li>
</ul>
<h4 id="to-supplement"><a href="#to-supplement" class="headerlink" title="to supplement:"></a>to supplement:</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>()&#xFF1A;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x8BE5;&#x6570;&#x7EC4;&#x5305;&#x542B;&#x5BF9;&#x8C61;&#x81EA;&#x8EAB;&#xFF08;&#x4E0D;&#x5305;&#x62EC;&#x539F;&#x578B;&#x94FE;&#xFF09;&#x7684;&#x6240;&#x6709;&#x53EF;&#x679A;&#x4E3E;&#x5C5E;&#x6027;&#x7684;&#x540D;&#x79F0;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</span><br><span class="line"><span class="keyword">const</span> obj = { <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> };</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)); <span class="comment">// &#x8F93;&#x51FA;&#xFF1A;[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span></span><br><span class="line"><span class="keyword">for</span>...<span class="keyword">in</span> &#x5FAA;&#x73AF;&#xFF1A;&#x8FD9;&#x4E2A;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x5BF9;&#x8C61;&#x81EA;&#x8EAB;&#x7684;&#x548C;&#x7EE7;&#x627F;&#x7684;&#x6240;&#x6709;&#x53EF;&#x679A;&#x4E3E;&#x5C5E;&#x6027;&#xFF08;&#x5305;&#x62EC;&#x539F;&#x578B;&#x94FE;&#xFF09;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</span><br><span class="line"><span class="keyword">const</span> obj = { <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> };</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) {</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key); <span class="comment">// &#x8F93;&#x51FA;&#xFF1A;&quot;a&quot;&#xFF0C;&quot;b&quot;&#xFF0C;&quot;c&quot;</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="eg3"><a href="#eg3" class="headerlink" title="eg3"></a>eg3</h3><p>In the example below we use <code>ownKeys</code> trap to make <code>for..in</code> loop over <code>user</code>, and also <code>Object.keys</code> and <code>Object.values</code>, to skip properties starting with an underscore `_</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> user = {</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">30</span>,</span><br><span class="line">  <span class="attr">_password</span>: <span class="string">&quot;***&quot;</span>,</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">user = <span class="keyword">new</span> <span class="title class_">Proxy</span>(user, {</span><br><span class="line">  <span class="title function_">ownKeys</span>(<span class="params">target</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(target).<span class="title function_">filter</span>(<span class="function">(<span class="params">key</span>) =&gt;</span> !key.<span class="title function_">startsWith</span>(<span class="string">&quot;_&quot;</span>));</span><br><span class="line">  },</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;ownKeys&quot; filters out _password</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> user) <span class="title function_">alert</span>(key); <span class="comment">// name, then: age</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// same effect on these methods:</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(user)); <span class="comment">// name,age</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="title function_">values</span>(user)); <span class="comment">// John,30</span></span><br></pre></td></tr></table></figure>

<p><strong>To articulate</strong></p>
<p>No matter &#x201C;for in&#x201D; &#x201C;Object.keys&#x201D; or &#x201C;Object.values&#x201D;<br>Deep inside They still use the same list offered by [[OwnPropertyKeys]]<br>Different methods <strong>just filter the list with different ways.</strong> And &#x201C;ownKeys&#x201D; trap does something to the list (above:Object.keys(target).filter(key =&gt; !key.startsWith(&#x2018;_&#x2018;));)<br> <strong>before</strong> the &#x201C;for in&#x201D; &#x201C;Object.keys&#x201D; or &#x201C;Object.values&#x201D; can access the list.</p>
<h4 id="To-note-1"><a href="#To-note-1" class="headerlink" title="To note"></a>To note</h4><p>if we return a key that doesn&#x2019;t exist in the object, <code>Object.keys</code> won&#x2019;t list it:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> user = {};</span><br><span class="line"></span><br><span class="line">user = <span class="keyword">new</span> <span class="title class_">Proxy</span>(user, {</span><br><span class="line">  <span class="title function_">ownKeys</span>(<span class="params">target</span>) {</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>];</span><br><span class="line">  },</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(user)); <span class="comment">// &lt;empty&gt;</span></span><br></pre></td></tr></table></figure>

<p>the trap return a list full of keys But none of these keys exist in the &#x201C;user &#x201C;object<br><strong>Why?</strong> The reason is simple: <code>Object.keys</code> returns only properties <strong>with the <code>enumerable</code> flag.</strong></p>
<p>the properties of [&#x2018;a&#x2019;, &#x2018;b&#x2019;, &#x2018;c&#x2019;] don&#x2019;t have the flag But how does Object.keys find out?<br>Object.keys check for it by calling the internal method <code>[[GetOwnProperty]]</code> of &#x201C;user&#x201D; for every property to get its <strong>descriptor</strong><br>And here, as there&#x2019;s no property in user, its descriptor is empty, no <code>enumerable</code> flag, so the listing-properties procedure is skipped.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> user = {};</span><br><span class="line"></span><br><span class="line">user = <span class="keyword">new</span> <span class="title class_">Proxy</span>(user, {</span><br><span class="line">  <span class="title function_">ownKeys</span>(<span class="params">target</span>) {</span><br><span class="line">    <span class="comment">// called once to get a list of properties</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>];</span><br><span class="line">  },</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getOwnPropertyDescriptor</span>(<span class="params">target, prop</span>) {</span><br><span class="line">    <span class="comment">// called for every property</span></span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">/* ...other flags, probable &quot;value:...&quot; */</span></span><br><span class="line">    };</span><br><span class="line">  },</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(user)); <span class="comment">// a, b, c</span></span><br></pre></td></tr></table></figure>

<p>when Object.keys is checking by calling the internal method <code>[[GetOwnProperty]]</code>of &#x201C;user&#x201D;<br>the calling will be intercepted and Object.keys will receive the informing-letter(haha) which is written &#x201C;it&#x2019;s enumable&#x201D;</p>
<h2 id="Convention"><a href="#Convention" class="headerlink" title="Convention"></a>Convention</h2><ol>
<li>There&#x2019;s a widespread convention that properties and methods prefixed by an underscore <code>_</code> are internal. They shouldn&#x2019;t be accessed from outside the object.</li>
<li>(prop can be seen as a key in the wrapped object&#x2019;s key-value pair)</li>
<li>target in &#x201C;get(target,prop)&#x201D; is the original object</li>
</ol>
<h2 id="deleteProperty"><a href="#deleteProperty" class="headerlink" title="deleteProperty"></a>deleteProperty</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> user = {</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  <span class="attr">_password</span>: <span class="string">&quot;secret&quot;</span>,</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(user.<span class="property">_password</span>); <span class="comment">// secret</span></span><br></pre></td></tr></table></figure>

<h3 id="eg4"><a href="#eg4" class="headerlink" title="eg4"></a>eg4</h3><p>Let&#x2019;s use proxies to prevent any access to properties starting with <code>_</code>.</p>
<p>We&#x2019;ll need these traps to accomplish an internal property:</p>
<ul>
<li><code>get</code> to throw an error when reading such property,</li>
<li><code>set</code> to throw an error when writing,</li>
<li><code>deleteProperty</code> to throw an error when deleting,</li>
<li><code>ownKeys</code> to exclude properties starting with <code>_</code> from <code>for..in</code> and methods like <code>Object.keys</code>.</li>
</ul>
<p>here is how we approach that:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> user = {</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  <span class="attr">_password</span>: <span class="string">&quot;***&quot;</span>,</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">user = <span class="keyword">new</span> <span class="title class_">Proxy</span>(user, {</span><br><span class="line">  <span class="title function_">get</span>(<span class="params">target, prop</span>) {</span><br><span class="line">    <span class="keyword">if</span> (prop.<span class="title function_">startsWith</span>(<span class="string">&quot;_&quot;</span>)) {</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Access denied&quot;</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">let</span> value = target[prop];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">&quot;function&quot;</span> ? value.<span class="title function_">bind</span>(target) : value; <span class="comment">// (*)</span></span><br><span class="line">  },</span><br><span class="line">  <span class="title function_">set</span>(<span class="params">target, prop, val</span>) {</span><br><span class="line">    <span class="comment">// to intercept property writing</span></span><br><span class="line">    <span class="keyword">if</span> (prop.<span class="title function_">startsWith</span>(<span class="string">&quot;_&quot;</span>)) {</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Access denied&quot;</span>);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      target[prop] = val;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  <span class="title function_">deleteProperty</span>(<span class="params">target, prop</span>) {</span><br><span class="line">    <span class="comment">// to intercept property deletion</span></span><br><span class="line">    <span class="keyword">if</span> (prop.<span class="title function_">startsWith</span>(<span class="string">&quot;_&quot;</span>)) {</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Access denied&quot;</span>);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      <span class="keyword">delete</span> target[prop];</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  <span class="title function_">ownKeys</span>(<span class="params">target</span>) {</span><br><span class="line">    <span class="comment">// to intercept property list</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(target).<span class="title function_">filter</span>(<span class="function">(<span class="params">key</span>) =&gt;</span> !key.<span class="title function_">startsWith</span>(<span class="string">&quot;_&quot;</span>));</span><br><span class="line">  },</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;get&quot; doesn&apos;t allow to read _password</span></span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">  <span class="title function_">alert</span>(user.<span class="property">_password</span>); <span class="comment">// Error: Access denied</span></span><br><span class="line">} <span class="keyword">catch</span> (e) {</span><br><span class="line">  <span class="title function_">alert</span>(e.<span class="property">message</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;set&quot; doesn&apos;t allow to write _password</span></span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">  user.<span class="property">_password</span> = <span class="string">&quot;test&quot;</span>; <span class="comment">// Error: Access denied</span></span><br><span class="line">} <span class="keyword">catch</span> (e) {</span><br><span class="line">  <span class="title function_">alert</span>(e.<span class="property">message</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;deleteProperty&quot; doesn&apos;t allow to delete _password</span></span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">  <span class="keyword">delete</span> user.<span class="property">_password</span>; <span class="comment">// Error: Access denied</span></span><br><span class="line">} <span class="keyword">catch</span> (e) {</span><br><span class="line">  <span class="title function_">alert</span>(e.<span class="property">message</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;ownKeys&quot; filters out _password</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> user) <span class="title function_">alert</span>(key); <span class="comment">// name</span></span><br></pre></td></tr></table></figure>

<p>To explain:</p>
<ol>
<li><p>get: the throwing-error part is obvious But why do we need to return a function binded to the object &#x201C;target&#x201D;when what we try to use[[Get]] to get is a function<br>Because:<br>In real-life code there will absolutely be a method in the <em>original object</em> that can access the internal value(_ prefixed)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">user = {</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">checkPassword</span>(<span class="params">value</span>) {</span><br><span class="line">    <span class="comment">// object method must be able to read _password</span></span><br><span class="line">    <span class="keyword">return</span> value === <span class="variable language_">this</span>.<span class="property">_password</span>;</span><br><span class="line">  },</span><br><span class="line">};</span><br></pre></td></tr></table></figure>

<p>for example <em>above</em> should be working properly! But with the trap &#x201C;get&#x201D; is set already when you write user.checkPassword &#x201C;this._password&#x201D; will activate the trap which will deny your access So the checkPassword won&#x2019;t be working.<br>After you set &#x201C;value.bind(target)&#x201D; actually you are bonding the context of the method(signing &#x201C;this&#x201D; to the) to target (we know it&#x2019;s the original object) And in the target(the original object) there are no traps at all.<br><strong>To be more clear : You need to ensure when &#x201C;checkPassword&#x201D; is working its(&#x201C;checkPassword&#x201D;) &#x201C;this&#x201D; should point to the &#x201C;obedient&#x201D;(no traps)object to ensure it (&#x201C;checkPassword&#x201D;) functions!(&#x8D77;&#x4F5C;&#x7528;)</strong></p>
</li>
</ol>
<p>That solution usually works, but isn&#x2019;t ideal</p>
<ol start="2">
<li>the rest is simple</li>
</ol>
<h2 id="In-to-has-trap"><a href="#In-to-has-trap" class="headerlink" title="In to has trap"></a>In to has trap</h2><p>As you can see above(in the internal method and handler method). The has trap intercept the &#x201C;in&#x201D; operator(which operate on the proxy object)because the in operator will invoke the <code>[[HasProperty]]</code></p>
<h3 id="eg5"><a href="#eg5" class="headerlink" title="eg5"></a>eg5</h3><p>We&#x2019;d like to use the <code>in</code> operator to check that a number is in <code>range</code>.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> range = {</span><br><span class="line">  <span class="attr">start</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">end</span>: <span class="number">10</span>,</span><br><span class="line">};</span><br><span class="line">proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(range, {</span><br><span class="line">  <span class="title function_">has</span>(<span class="params">target, prop</span>) {</span><br><span class="line">    <span class="keyword">return</span> prop &gt;= target.<span class="property">start</span> &amp;&amp; prop &lt;= target.<span class="property">end</span>;</span><br><span class="line">  },</span><br><span class="line">});</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span> <span class="keyword">in</span> proxy); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<h2 id="Wrapping-functions-&#x201D;apply&#x201D;"><a href="#Wrapping-functions-&#x201D;apply&#x201D;" class="headerlink" title="Wrapping functions:&#x201D;apply&#x201D;"></a>Wrapping functions:&#x201D;apply&#x201D;</h2><p>You should see the article Decortor and forwarding,call/apply first to understand this section</p>
]]></content>
      <categories>
        <category>Front-end</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>Proxy</tag>
      </tags>
  </entry>
  <entry>
    <title>Server</title>
    <url>/2024/10/07/2024-10-07-Server-2024/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h1><p>Browser is the middleman between you and Server.</p>
<p>A server is a provider that offers services . It can be visualize as a computer being open all the time 24/7.</p>
<span id="more"></span>

<p>the websites you visit and the webpages you view doesn&#x2019;t belong to the browser <br> It originally comes from server.</p>
<h1 id="IP-Port"><a href="#IP-Port" class="headerlink" title="IP Port"></a>IP Port</h1><p>Every server has a unique ip address to be differentiated But it&#x2019;s digits composed which makes it not readable <br> So domain shows up .<strong>Domain is example.com</strong></p>
<h1 id="Domain"><a href="#Domain" class="headerlink" title="Domain"></a>Domain</h1><p>&#x57DF;&#x540D;&#x662F;&#x6709;&#x5C42;&#x6B21;&#x7684;&#xFF0C;&#x5206;&#x4E3A;&#x9876;&#x7EA7;&#x57DF;&#x540D;&#xFF08;TLD&#xFF09;&#x3001;&#x4E8C;&#x7EA7;&#x57DF;&#x540D;&#xFF08;SLD&#xFF09;&#x548C;&#x4E09;&#x7EA7;&#x57DF;&#x540D;<br>&#x9876;&#x7EA7;&#x57DF;&#x540D;&#xFF08;TLD&#xFF09;&#xFF1A;&#x57DF;&#x540D;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6700;&#x9AD8;&#x7EA7;&#x522B;&#xFF0C;&#x4F4D;&#x4E8E;&#x57DF;&#x540D;&#x7684;&#x6700;&#x53F3;&#x4FA7;&#xFF0C;&#x901A;&#x5E38;&#x7531;&#x51E0;&#x4E2A;&#x5B57;&#x6BCD;&#x7EC4;&#x6210;&#x3002; TLD &#x5206;&#x4E3A;&#x901A;&#x7528; TLD &#x548C;&#x56FD;&#x5BB6;&#x4EE3;&#x7801; TLD&#xFF0C;&#x5E38;&#x89C1;&#x7684;&#x901A;&#x7528;&#x901A;&#x7528; TLD &#x5305;&#x62EC;&#x4EE3;&#x8868;&#x5546;&#x4E1A;&#x4F01;&#x4E1A;&#x7684;.com&#x3001;&#x4EE3;&#x8868;&#x7F51;&#x7EDC;&#x63D0;&#x4F9B;&#x5546;&#x7684;.net&#x3001;&#x4EE3;&#x8868;&#x975E;&#x8425;&#x5229;&#x7EC4;&#x7EC7;&#x7684;.org&#xFF0C;&#x800C;&#x56FD;&#x5BB6;&#x4EE3;&#x7801; TLD &#x5219;&#x4EE3;&#x8868;&#x7279;&#x5B9A;&#x7684;&#x56FD;&#x5BB6;&#x6216;&#x5730;&#x533A;&#xFF0C;&#x4F8B;&#x5982;.cn &#x4EE3;&#x8868;&#x4E2D;&#x56FD;&#xFF0C;.uk &#x4EE3;&#x8868;&#x82F1;&#x56FD;&#x3002;<br>&#x4E8C;&#x7EA7;&#x57DF;&#x540D; (SLD)&#xFF1A;&#x4F4E;&#x4E8E; TLD &#x7684;&#x7EA7;&#x522B;&#xFF0C;&#x7531;&#x6CE8;&#x518C;&#x4EBA;&#x9009;&#x62E9;&#x548C;&#x6CE8;&#x518C;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x4E2A;&#x6027;&#x5316;&#x4E14;&#x6613;&#x4E8E;&#x8BB0;&#x5FC6;&#x7684;&#x540D;&#x79F0;&#x3002;&#x4F8B;&#x5982;&#xFF0C;juejin.cn &#x662F;&#x4E8C;&#x7EA7;&#x57DF;&#x540D;&#xFF0C;&#x901A;&#x5E38;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7533;&#x8BF7;<br>&#x4E09;&#x7EA7;&#x57DF;&#xFF08;3LD&#xFF09;&#xFF1A;&#x5728;&#x4E8C;&#x7EA7;&#x57DF;&#x4E4B;&#x4E0B;&#xFF0C;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x6307;&#x5411;&#x7279;&#x5B9A;&#x7684;&#x670D;&#x52A1;&#x5668;&#x6216;&#x5B50;&#x7F51;&#x3002;&#x5728; blog.example.com &#x4E2D;&#xFF0C;&#x201C;blog&#x201D;&#x662F;&#x4E00;&#x4E2A;&#x4E09;&#x7EA7;&#x57DF;&#x540D;&#x3002; &#x201C;www&#x201D;&#x662F;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x4E09;&#x7EA7;&#x57DF;&#x540D;&#xFF0C;&#x4EE3;&#x8868;&#x7F51;&#x7AD9;&#x7684;&#x4E3B;&#x9875;&#x6216;&#x4E3B;&#x7AD9;&#x70B9;&#xFF0C;&#x4F46;&#x8FD9;&#x53EA;&#x662F;&#x4E00;&#x79CD;&#x7EA6;&#x5B9A;&#xFF0C;&#x73B0;&#x5728;&#x8BB8;&#x591A;&#x7F51;&#x7AD9;&#x5EFA;&#x8BAE;&#x901A;&#x8FC7;&#x4E8C;&#x7EA7;&#x57DF;&#x540D;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x3002;</p>
<p><strong>So</strong> when you put a URL including domain onto the browser&#x2019;s search bar The browser parses it into IP address (using DNS) in order to get you accessed to the right server</p>
<p>The protocols are well known as <strong>http and https</strong> <br>These are specifically created for <strong>webpage-transmit</strong> These two specify the <strong>rules</strong> that should be followed by both server and browser (client) during the transmission.</p>
<p>BUT website is just one of the many services that a server can provide and <strong>output by the specific port</strong> &#xFF08;80 443&#xFF09;</p>
<p>The Internet request when you are expecting a webpage is sent to the server by the browser<br>And To be concrete to port 80 /443 <strong>of</strong> the server(Biu!!!)</p>
<hr>

<p>I want to clarify that Multiple network applications might be deployed on a Server. Which one should receive the request?<br>a server can host many services, not just websites, and each service typically runs on different port of the server.</p>
]]></content>
      <tags>
        <tag>Server</tag>
        <tag>http</tag>
        <tag>https</tag>
        <tag>domain</tag>
      </tags>
  </entry>
  <entry>
    <title>What happens when you type a URL into your browser?</title>
    <url>/2024/10/15/2024-10-15-How-browser-retrieve-your-website-2024/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>In the modern age of the internet, where accessing information is just a click away, the journey of a URL from the moment it&#x2019;s typed into the browser to the display of the desired webpage is <strong>an intricate process</strong> involving various components of the web stack.</p>
<h1 id="DNS-Look-up"><a href="#DNS-Look-up" class="headerlink" title="DNS Look up"></a>DNS Look up</h1><p>Your browser first channels the Domain Name System (DNS) to translate the human-readable URL (like <a href="http://www.example.com/">www.example.com</a>) into an IP address (e.g., 123.456.78.90), which identifies the server where the website is hosted.<br><br>To make this lookup process fast, the DNS information is <strong>heavily cached.</strong><br>1.First the browser itself <strong>caches</strong> it for a short period of time. And if it is not in the browser&#x2019;s cache .The browser asks the operating system for it.<br>2.Also,The operating system itself has a <strong>cache</strong> for it&#x2026; which also keeps the answer for a short period of time.</p>
<p>if the operating operating system doesn&#x2019;t have it, it makes a query out to the internet <strong>to a DNS resolver.</strong> This sets off a <strong>chain</strong> of requests (Recursive lookup to the DNS Server ) until the IP address is <strong>resolved.</strong></p>
<h1 id="Using-IP-to-establish-TCP-connection"><a href="#Using-IP-to-establish-TCP-connection" class="headerlink" title="Using IP to establish TCP connection"></a>Using IP to establish TCP connection</h1><p>there&#x2019;s a <strong>handshake-process</strong> involved in establishing <strong>a TCP connection</strong>. It takes several network-round-trips for this to complete. To keep the loading process fast, modern browsers use something called a keep-alive connection to try to reuse an established TCP connection to the server as much as possible.</p>
<p>This handshake is expensive and the browsers use tricks like SSL session resumption to try to lower the cost. Finally, the browser sends an HTTP request to the server over the established TCP connection.</p>
<h1 id="HTTP-Request"><a href="#HTTP-Request" class="headerlink" title="HTTP Request"></a>HTTP Request</h1><p><strong>HTTP Request</strong>: After getting the IP address, the browser sends an HTTP request to the server asking for the website&#x2019;s content, like &#x201C;Hey, give me the page at this URL.&#x201D;</p>
<h1 id="Server-Response"><a href="#Server-Response" class="headerlink" title="Server Response"></a><strong>Server Response</strong></h1><p><strong>Server Response</strong>: The server processes the request and sends back a response, which usually includes the HTML, CSS, JavaScript, and sometimes images or videos that make up the website.</p>
<p>The browser receives the response and renders html content. Oftentimes there are additional resources to load, like javascript bundles and images.</p>
<h1 id="resource-fetching"><a href="#resource-fetching" class="headerlink" title="resource fetching."></a><strong>resource fetching.</strong></h1><p>The browser repeats the process above that we mentioned to finish fetching all the other resources.</p>
<p>When a browser receives the <strong>initial HTML content</strong>, it often contains <strong>links to</strong> other resources like JavaScript, CSS, and images. The browser then <strong>repeats</strong> the process of making <strong>additional HTTP requests</strong> to fetch each of those resources.</p>
<p>This entire flow of making multiple requests and processing them to fully load a website is called the <strong>&#x201C;resource loading process&#x201D;</strong> or <strong>&#x201C;resource fetching.&#x201D;</strong></p>
<p>To optimize this, browsers handle many of these requests <strong>in parallel</strong>, fetching multiple resources simultaneously to speed things up. So, even though many requests are made, they aren&#x2019;t strictly sequential; they happen concurrently, making the site load faster.</p>
<h1 id="Rendering"><a href="#Rendering" class="headerlink" title="Rendering"></a><strong>Rendering</strong></h1><p><strong>Rendering</strong>: Your browser then takes this response and renders it, displaying the website visually for you to interact with.</p>
<hr>

<p>So basically, the browser is like a translator and a middleman between you and the server.</p>
]]></content>
      <categories>
        <category>Internet</category>
      </categories>
      <tags>
        <tag>Server</tag>
        <tag>http</tag>
        <tag>https</tag>
        <tag>domain</tag>
        <tag>Browser</tag>
        <tag>URL</tag>
      </tags>
  </entry>
  <entry>
    <title>Bubbling and capturing</title>
    <url>/2024/10/22/Bubbling%20and%20capturing/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://s3.bmp.ovh/imgs/2024/10/22/c40d807ad0034767.png"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(&apos;The handler!&apos;)&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">em</span></span></span><br><span class="line"><span class="tag">    &gt;</span>If you click on <span class="tag">&lt;<span class="name">code</span>&gt;</span>EM<span class="tag">&lt;/<span class="name">code</span>&gt;</span>, the handler on <span class="tag">&lt;<span class="name">code</span>&gt;</span>DIV<span class="tag">&lt;/<span class="name">code</span>&gt;</span> runs.&lt;/em</span><br><span class="line">  &gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>This handler is assigned to div, but <strong>also runs</strong> if you click any nested tag like em or code:<br>Why does the handler on <strong>div</strong> run even if the actual click was on <strong>em</strong>?</p>
<h1 id="Bubbling"><a href="#Bubbling" class="headerlink" title="Bubbling"></a>Bubbling</h1><p>When an event happens on an element(like click on a button), it first runs the handlers on it, then on its parent, then all the way up on other <strong>ancestors.</strong><br><img src="https://s3.bmp.ovh/imgs/2024/10/22/9d20d1c154df1a4d.png"></p>
<h2 id="event-target"><a href="#event-target" class="headerlink" title="event.target"></a>event.target</h2><p><strong>A handler on a parent element</strong> can always get the information about where it actually happened.</p>
<p>The most deeply nested element that caused the event is called a target element, accessible as event.target.</p>
<p>Note the differences from</p>
<ol>
<li><p>this (=event.currentTarget): this &#x2013; is the &#x201C;current&#x201D; element, the one that <strong>has a currently running handler</strong> on it.</p>
</li>
<li><p>event.target &#x2013; is the &#x201C;target&#x201D; element that <strong>initiated the event,</strong> it doesn&#x2019;t change through the bubbling process.</p>
</li>
</ol>
<h3 id="example&#xFF1A;form"><a href="#example&#xFF1A;form" class="headerlink" title="example&#xFF1A;form"></a>example&#xFF1A;form</h3><p>For instance, if we have a single handler form.onclick, then it can &#x201C;catch&#x201D; all clicks inside the form. No matter where the click happened, it bubbles up to <form> and runs the handler.</form></p>
<p>In form.onclick handler:</p>
<p>this (=event.currentTarget) is the <form> element, because the handler runs on it.<br>event.target is the actual element inside the form that was clicked.</form></p>
<h1 id="Stop-bubbling"><a href="#Stop-bubbling" class="headerlink" title="Stop bubbling"></a>Stop bubbling</h1><p>A bubbling event goes from the target element straight up. Normally it goes upwards till <code>&lt;html&gt;</code>, and then to <code>document</code> object, and some events even reach <code>window</code>, <strong>calling all handlers on the path</strong>.</p>
<p>**But any handler can decide that the event has been fully processed and stop the bubbling.**which is to say &#x201C;this is enough, I don&#x2019;t want this event to be known by other handlers&#x201D;.</p>
<p>The method for it is <code>event.stopPropagation()</code>.</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(`the bubbling doesn&apos;t reach here`)&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;event.stopPropagation()&quot;</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="event-stopImmediatePropagation"><a href="#event-stopImmediatePropagation" class="headerlink" title="event.stopImmediatePropagation()."></a><code>event.stopImmediatePropagation()</code>.</h2><p>If an element has multiple event handlers on a single event, then even if one of them stops the bubbling, the other ones still execute.</p>
<p>In other words, <code>event.stopPropagation()</code> stops the move upwards, but on the current element all other handlers will run.</p>
<p>To stop the bubbling and prevent handlers on the current element from running, there&#x2019;s a method <code>event.stopImmediatePropagation()</code>. After you use this <code>event.stopImmediatePropagation()</code> no other handlers will execute.</p>
<h2 id="event-preventDefault"><a href="#event-preventDefault" class="headerlink" title="event.preventDefault();"></a>event.preventDefault();</h2><p>What is default behavior&#xFF1F;</p>
<p>It is the default behavior of the browser <strong>in response to the event</strong> like click, keypress, submit, etc.</p>
<p>For example:</p>
<ul>
<li>Click the &#x201C;Submit&#x201D; button in the form, the browser will submit the form by default.</li>
<li>Press the Enter key in the text box, the browser will perform the submit operation by default.</li>
<li>Trigger the <code>copy</code> event, the browser will copy the selected text to the clipboard by default.</li>
</ul>
<h1 id="Capturing"><a href="#Capturing" class="headerlink" title="Capturing"></a>Capturing</h1><p>There&#x2019;s another phase of event processing called &#x201C;capturing&#x201D;. It is rarely used in real code, but sometimes can be useful.</p>
<p>The standard <a href="https://www.w3.org/TR/DOM-Level-3-Events/">DOM Events</a> describes 3 phases of event propagation:</p>
<ol>
<li>Capturing phase &#x2013; the event goes down to the element.</li>
<li>Target phase &#x2013; the event reached the target element.</li>
<li>Bubbling phase &#x2013; the event bubbles up from the element.</li>
</ol>
<p><img src="https://s3.bmp.ovh/imgs/2024/10/22/1b28efb367e3bce0.png"></p>
<p><img src="https://s3.bmp.ovh/imgs/2024/10/22/46932dc2a35503c3.png"></p>
<h1 id="addeventListener"><a href="#addeventListener" class="headerlink" title="addeventListener"></a>addeventListener</h1><p>&#x4ED6;&#x7684;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x503C;&#xFF0C;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E; true/false &#x5C31;&#x662F;&#x5728;&#x4E0D;&#x540C;&#x9636;&#x6BB5;&#x8BBE;&#x8BA1;&#x76D1;&#x542C;&#x5668;&#xFF0C;true &#x8868;&#x793A;&#x5728;&#x6355;&#x83B7;&#x9636;&#x6BB5;&#xFF0C;false &#x5728;&#x6309;&#x7167;&#x5192;&#x6CE1;&#x9636;&#x6BB5;&#x3002;</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> button = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;button&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> span = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;span&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> body = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;body&quot;</span>);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Name</span>(<span class="params"></span>) {</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">nodeName</span>);</span><br><span class="line">}</span><br><span class="line">button.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="title class_">Name</span>, <span class="literal">false</span>);</span><br><span class="line">span.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="title class_">Name</span>, <span class="literal">false</span>);</span><br><span class="line">body.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="title class_">Name</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x4F60;&#x70B9;&#x51FB; span &#x65F6;&#xFF0C;&#x4F1A;&#x4F9D;&#x6B21;&#x8F93;&#x51FA; span button body&#xFF0C;&#x56E0;&#x4E3A;&#x4E8B;&#x4EF6;&#x662F;&#x4ECE; span &#x5F00;&#x59CB;&#x5192;&#x6CE1;&#x5230; button &#x518D;&#x5192;&#x6CE1;&#x5230; body &#x7684;&#x3002;<br>&#x4F46;&#x5F53;&#x4F60;&#x70B9;&#x51FB; body &#x53EA;&#x6709; body &#x4F1A;&#x8F93;&#x51FA; &#x56E0;&#x4E3A;&#x5DF2;&#x7ECF;&#x5230;&#x8FBE;&#x4E86;&#x5143;&#x7D20; &#x4ED6;&#x5F80;&#x4E0A;&#x5192;&#x6CE1;&#x6CA1;&#x6709;&#x76D1;&#x542C;&#x5668;&#x4E86;&#x3002;</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> button = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;button&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> span = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;span&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> body = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;body&quot;</span>);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Name</span>(<span class="params"></span>) {</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">nodeName</span>);</span><br><span class="line">}</span><br><span class="line">button.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="title class_">Name</span>, <span class="literal">true</span>);</span><br><span class="line">span.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="title class_">Name</span>, <span class="literal">true</span>);</span><br><span class="line">body.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="title class_">Name</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<p><strong>&#x73B0;&#x5728;&#x5F53;&#x4F60;&#x70B9;&#x51FB; body &#x4F1A;&#x4F9D;&#x6B21;&#x8F93;&#x51FA; body &#x4E5F;&#x53EA;&#x4F1A;&#x8F93;&#x51FA; body &#x56E0;&#x4E3A;&#x5DF2;&#x7ECF;&#x5230;&#x8FBE;&#x5143;&#x7D20; target &#x4E86; &#x5F53;&#x4F60;&#x70B9;&#x51FB; body body &#x5C31;&#x662F;&#x76EE;&#x6807;&#x5143;&#x7D20; &#x8FD9;&#x4E2A;&#x6355;&#x83B7;&#x9636;&#x6BB5;&#x662F;&#x4ECE; window-&gt;body &#x800C;&#x4E0D;&#x662F; body-&gt;button-&gt;span</strong></p>
<h1 id="&#x4E8B;&#x4EF6;&#x6D41;"><a href="#&#x4E8B;&#x4EF6;&#x6D41;" class="headerlink" title="&#x4E8B;&#x4EF6;&#x6D41;"></a>&#x4E8B;&#x4EF6;&#x6D41;</h1><p>&#x65E2;&#x6709;&#x5192;&#x6CE1;&#x53C8;&#x6709;&#x6355;&#x83B7; &#x4F46;&#x662F;&#x6309;&#x7167;&#x524D;&#x9762;&#x7684;&#x8FC7;&#x5C71;&#x8F66; &#x6355;&#x83B7;&#x4F18;&#x5148;&#x4E8E;&#x5192;&#x6CE1;<br>&#x5F53;&#x4F60;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x540E; &#x6D4F;&#x89C8;&#x5668;&#x5148;&#x770B;&#x4F60;&#x6355;&#x83B7;&#x9636;&#x6BB5;&#x6709;&#x6CA1;&#x6709;&#x76D1;&#x542C;&#x5668; &#x518D;&#x5230;&#x4F60;&#x7684;&#x5143;&#x7D20;&#x4E0A;&#x7684;&#x76D1;&#x542C;&#x5668; &#x518D;&#x770B;&#x4F60;&#x7684;&#x5192;&#x6CE1;&#x9636;&#x6BB5;&#x6709;&#x6CA1;&#x6709;&#x76D1;&#x542C;&#x5668;</p>
<p><img src="https://s3.bmp.ovh/imgs/2024/10/22/0604a69b22152556.png"></p>
<p><img src="https://s3.bmp.ovh/imgs/2024/10/22/9ffa9d7610d4de7b.png"></p>
<p>&#x70B9;&#x51FB;&#x5143;&#x7D20;&#xFF0C;&#x89E6;&#x53D1;&#x4E00;&#x4E2A;&#x4E8B;&#x4EF6;&#x6D41;&#x5230;&#x8FBE;&#x4ED6; &#x6D4F;&#x89C8;&#x5668;&#x4ECE; window &#x5F00;&#x59CB;&#x6355;&#x83B7;&#x5230;&#x8FBE;&#x5143;&#x7D20; &#x518D;&#x4ECE;&#x5143;&#x7D20;&#x5192;&#x6CE1;&#x5230; window &#x6CBF;&#x8DEF;&#x53D1;&#x73B0; mother &#x548C; daughter &#x7684;&#x76D1;&#x542C;&#x5668; &#x7136;&#x540E;&#x5230;&#x8FBE;&#x5143;&#x7D20; baby &#x7684; &#x5192;&#x6CE1;&#x5230;&#x8FBE; grandma &#x4E0D;&#x4F1A;&#x518D;&#x53BB;&#x6267;&#x884C; mother &#x548C; daughter &#x7684;&#x76D1;&#x542C;&#x5668; &#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x76D1;&#x542C;&#x5668;&#x8BBE;&#x5728;&#x6355;&#x83B7;&#x9636;&#x6BB5;</p>
]]></content>
      <tags>
        <tag>Javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>Virtual Memory</title>
    <url>/2024/10/20/Virtual%20Memory/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>You open a web browser, a text editor, and a game concurrently. Together, these applications consume <strong>10 GB of RAM</strong>.</p>
<span id="more"></span>

<p>Since you only have 8 GB of physical RAM, the system cannot keep all the data in RAM <strong>at once</strong>.<br>So OS uses a technique to do that:<br>Use the disk to temporarily store <strong>less-used</strong> data and free up RAM for <strong>more important</strong> data. Like 2GB of data is stored in the disk and 8GB of data is stored in the RAM.<br>When an application needs more RAM to process or generate more data, add new features, or respond to user actions, it can request additional RAM from the operating system. If the physical RAM is insufficient, the OS manages memory by swapping less-used data to disk to free up RAM for the application.</p>
<h1 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h1><p><strong>Virtual memory</strong> is a memory management <strong>technique</strong> that allows an application to use <strong>more</strong> memory than what is physically available on the system. It does this by using disk space as an <strong>extension</strong> of RAM.</p>
<p>What to do when the CPU needs to access the <strong>less-used</strong> data that is not in the memory since you have removed it?<br>The OS load the corresponding data from disk to the memory<br><img src="https://imgur.com/7Uu9Dge.png"></p>
<h1 id="Why-this-called-Virtual-Memory"><a href="#Why-this-called-Virtual-Memory" class="headerlink" title="Why this called Virtual Memory?"></a>Why this called Virtual Memory?</h1><p>Virtual Memory is for the Program to say.<br>The memory space is numbered, that is, each small block of memory has its own address.<br>There are two types of addresses:Virtual Address and Physical Address<br>From this 10GB Program&#x2019;s perspective,it sees a table of numbers that is 10GB in size., And When it needs to access data, it uses virtual addresses within that 10GB space.</p>
<h1 id="Senario"><a href="#Senario" class="headerlink" title="Senario"></a>Senario</h1><p>So, when an instruction in your game says to go to address 1000 to get the health-value data of this user, will the CPU go to address 1000 to get it?What if it does go to address 1000,what will it get? No,it will not get the health-value data of this user, So, how does the CPU know where is the right place to get the data? This is where the MMU comes in.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MOV REG,1000  this instruction loads a value from the virtual address 1000 into a register</span><br></pre></td></tr></table></figure>

<p>this 1000 is virtual-address.The cpu will parse this instruction<br>After that the parsing-result will be sent to MMU</p>
<h2 id="MMU"><a href="#MMU" class="headerlink" title="MMU"></a>MMU</h2><p>MMU is an address translator<br>It converts virtual addresses into physical addresses</p>
<p>So after the MMU conversion, the CPU uses this physical address to go to the right place to access the memory (read memory&#x2018;s data or write data to the memory).</p>
<pre><code>      +---------------------+
      |         CPU         |
      |                     |
      |   MOV REG, 1000    |
      +----------+----------+
                 |
                 | (&#x865A;&#x62DF;&#x5730;&#x5740;: 1000)
                 v
      +---------------------+
      |         MMU         |
      |  (&#x5730;&#x5740;&#x8F6C;&#x6362;&#x5668;)       |
      +----------+----------+
                 |
                 | (&#x7269;&#x7406;&#x5730;&#x5740;&#x8F6C;&#x6362;)
                 v
      +---------------------+
      |     &#x7269;&#x7406;&#x5730;&#x5740;        |
      |                     |
      |   (&#x8BFB;/&#x5199;&#x6570;&#x636E;)      |
      +----------+----------+
</code></pre>
<h1 id="How-MMU-works"><a href="#How-MMU-works" class="headerlink" title="How MMU works"></a>How MMU works</h1><ol>
<li><p>The CPU sends the virtual address to the <strong>MMU</strong> for translation. &#x201C;hey give me the actual address of this virtual address&#x201D;</p>
<p>The virtual address is divided into <strong>page number</strong> and <strong>offset</strong>.</p>
</li>
<li><p>The MMU checks the <strong>page table</strong> to find the corresponding <strong>physical address</strong>. How? It looks up the page table to see if the virtual address is mapped to a physical address.</p>
<p>If the entry exists, the physical address is retrieved.</p>
</li>
<li><p>The MMU sends the physical address to the memory controller.The controller is a part of the CPU that manages memory access.</p>
<p>The controller accesses the <strong>physical memory (RAM)</strong> to read or write data.</p>
</li>
<li><p>Page Fault Handling (if needed)</p>
</li>
</ol>
<p>If the virtual address isn&#x2019;t mapped which means a page fault occurs, the OS handles it by performing the following steps:</p>
<ul>
<li>Check if there are any free frames in memory.</li>
<li>If there are free frames, allocate one for the page.</li>
<li>If there are no free frames, select a victim page to evict from memory.</li>
<li>The OS retrieves the required data from <strong>disk storage</strong>. Load the required page from disk into the selected frame.</li>
<li>Update the page table with the new mapping.</li>
<li>Resume the interrupted instruction that caused the page fault.Which is Returns to step 3 to complete the address translation.</li>
</ul>
<p><img src="https://imgur.com/zjbcuyG.png"></p>
<h1 id="page-table"><a href="#page-table" class="headerlink" title="page-table"></a>page-table</h1><p>A <strong>page table</strong> is a <strong>data structure</strong> used by the MMU to translate virtual addresses to physical addresses.</p>
<p>It contains a list of <strong>page table entries (PTEs)</strong> that map virtual pages to physical frames. Each PTE includes:</p>
<ul>
<li>&#x6709;&#x6548;/&#x65E0;&#x6548;&#x4F4D;&#xFF1A;whether the page is currently loaded in memory</li>
<li>&#x7269;&#x7406;&#x5730;&#x5740;&#xFF1A;&#x6307;&#x5411;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x7269;&#x7406;&#x9875;&#x6846;</li>
<li>&#x5176;&#x4ED6;&#x63A7;&#x5236;&#x4F4D;&#xFF1A;&#x4F8B;&#x5982;&#x8BFB;/&#x5199;&#x6743;&#x9650;&#x3001;&#x7528;&#x6237;/&#x5185;&#x6838;&#x6743;&#x9650;&#x7B49;<br>so on</li>
</ul>
<p><img src="https://imgur.com/wHlFmqj.png"></p>
]]></content>
      <tags>
        <tag>计算机组成原理</tag>
        <tag>cs app</tag>
      </tags>
  </entry>
  <entry>
    <title>Siganls</title>
    <url>/2024/10/22/signal/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://raw.githubusercontent.com/tju-tomorrow/Image/main/img/202410230050367.png"></p>
<p>A signal is a mechanism for communication <strong>between processes.</strong> You can think of it like a notification that interrupts you, prompting you to pay attention to something important.</p>
<span id="more"></span>

<p><img src="https://raw.githubusercontent.com/tju-tomorrow/Image/main/img/202410230103511.png"><br>The signal is <strong>asynchronous</strong> (compared to hardware interrupts), and the arrival time and content of the signal are uncertain meaning you can&#x2019;t predict when a signal will arrive</p>
<p>The signal is essentially an int type digital number (pre-defined)<br>For example:1.<strong>SIGINT (2)</strong>: This signal interrupts a process. It&#x2019;s typically sent when you press <code>Ctrl+C</code> in a terminal to stop a running program. 2.<strong>SIGTERM (15)</strong>: This is a termination signal. It politely asks a process to terminate, allowing it to clean up resources before exiting.</p>
<h1 id="Who-sends-the-signal"><a href="#Who-sends-the-signal" class="headerlink" title="Who sends the signal:"></a>Who sends the signal:</h1><p>(1) The user presses a button on the <strong>terminal</strong></p>
<p>(2) The <strong>operating system</strong> kernel sends a signal after a hardware failure</p>
<p>(3) The user uses the <strong>kill command</strong> to send a signal to other processes</p>
<p>(4) A signal is also sent when certain software conditions are met, such as when the alarm time is reached, <strong>a SIGALARM signal is generated</strong>, and when writing to a pipe whose read end has been closed, a SIGPIPE signal is generated.</p>
<h1 id="Signals-can-be-handled-in-three-main-ways"><a href="#Signals-can-be-handled-in-three-main-ways" class="headerlink" title="Signals can be handled in three main ways:"></a>Signals can be handled in three main ways:</h1><p><img src="https://raw.githubusercontent.com/tju-tomorrow/Image/main/img/202410230101997.png"></p>
<ol>
<li><strong>Ignore the Signal</strong>: A process can choose to completely ignore a signal. It simply won&#x2019;t react to it at all, like ignoring someone who&#x2019;s trying to get your attention.</li>
<li><strong>Default Handling</strong>:This usually means either ignoring the signal or terminating the process,</li>
<li><strong>Capture the Signal</strong>: A process can also set up a function to respond to a signal. This means when the signal arrives, it runs the specified function instead of just ignoring it or terminating.</li>
</ol>
<h1 id="&#x8FDB;&#x7A0B;&#x7EC4;"><a href="#&#x8FDB;&#x7A0B;&#x7EC4;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x7EC4;"></a>&#x8FDB;&#x7A0B;&#x7EC4;</h1><p>When you start a process, it can create child processes, and these can be grouped together into a process group. This makes it easier to manage multiple processes as a single unit.</p>
<p>&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x90FD;&#x53EA;&#x5C5E;&#x4E8E;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;<br><img src="https://raw.githubusercontent.com/tju-tomorrow/Image/main/img/202410230113787.png"></p>
<p><code>getpgid</code> &#x548C; <code>setpgid</code> &#x6765;&#x83B7;&#x53D6;&#x548C;&#x8BBE;&#x7F6E;&#x8FDB;&#x7A0B;&#x7EC4;</p>
<ul>
<li><code>int getpgid(int pid)</code>&#xFF1A;&#x83B7;&#x53D6;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4; ID&#x3002;</li>
<li><code>int setpgid(int pid, int pgid)</code>&#xFF1A;&#x8BBE;&#x7F6E;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4; ID&#x3002;</li>
</ul>
<p>PGID&#xFF08;Process Group ID&#xFF0C;&#x8FDB;&#x7A0B;&#x7EC4; ID&#xFF09; &#x548C; PID&#xFF08;Process ID&#xFF0C;&#x8FDB;&#x7A0B; ID&#xFF09; &#x662F; Linux &#x7CFB;&#x7EDF;&#x4E2D;&#x7528;&#x4E8E;&#x6807;&#x8BC6;&#x8FDB;&#x7A0B;&#x548C;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x4E24;&#x4E2A;&#x91CD;&#x8981;&#x6807;&#x8BC6;&#x7B26;&#x3002;</p>
<ul>
<li>&#x8FDB;&#x7A0B;&#x7EC4;&#x901A;&#x5E38;&#x7531;&#x4E00;&#x4E2A; &#x201C;&#x7EC4;&#x957F;&#x201D; &#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#xFF0C;&#x5B83;&#x7684; PGID &#x548C;&#x5B83;&#x7684; PID &#x76F8;&#x540C;&#x3002;<strong>&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>setpgid</code> &#x51FD;&#x6570;&#x52A0;&#x5165;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;</strong></li>
<li>&#x6240;&#x6709;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;<strong>&#x5171;&#x4EAB;&#x76F8;&#x540C;&#x7684; PGID&#x3002;</strong></li>
</ul>
<p>Shell &#x4F5C;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;PID &#x4E3A; 10&#xFF0C;PGID &#x4E5F;&#x4E3A; 10&#xFF0C;&#x5B83;&#x7BA1;&#x7406;&#x4E86;&#x591A;&#x4E2A;&#x4F5C;&#x4E1A;&#xFF08;&#x524D;&#x53F0;&#x548C;&#x540E;&#x53F0;&#xFF09;</p>
<h2 id="&#x524D;&#x53F0;&#x540E;&#x53F0;"><a href="#&#x524D;&#x53F0;&#x540E;&#x53F0;" class="headerlink" title="&#x524D;&#x53F0;&#x540E;&#x53F0;"></a>&#x524D;&#x53F0;&#x540E;&#x53F0;</h2><ul>
<li><strong>&#x524D;&#x53F0;&#x4F5C;&#x4E1A;&#xFF08;Foreground job&#xFF09;</strong>&#xFF1A;<ul>
<li>&#x7531;&#x8FDB;&#x7A0B; PID 20&#xFF08;PGID 20&#xFF09;&#x7EC4;&#x6210;&#xFF0C;&#x8BE5;&#x4F5C;&#x4E1A;&#x4E0B;&#x6709;&#x4E24;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF08;PID 21 &#x548C; PID 22&#xFF09;&#xFF0C;&#x5B83;&#x4EEC;&#x7684; PGID &#x90FD;&#x662F; 20&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5B83;&#x4EEC;&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;</li>
</ul>
</li>
<li><strong>&#x540E;&#x53F0;&#x4F5C;&#x4E1A; 1&#xFF08;Background job #1&#xFF09;</strong>&#xFF1A;<ul>
<li>&#x7531;&#x8FDB;&#x7A0B; PID 32&#xFF08;PGID 32&#xFF09;&#x7EC4;&#x6210;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#xFF0C;&#x5176; PGID &#x548C; PID &#x76F8;&#x540C;&#x3002;</li>
</ul>
</li>
<li><strong>&#x540E;&#x53F0;&#x4F5C;&#x4E1A; 2&#xFF08;Background job #2&#xFF09;</strong>&#xFF1A;<ul>
<li>&#x7531;&#x8FDB;&#x7A0B; PID 40&#xFF08;PGID 40&#xFF09;&#x7EC4;&#x6210;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x540E;&#x53F0;&#x4F5C;&#x4E1A; 1&#xFF0C;&#x72EC;&#x7ACB;&#x8FD0;&#x884C;&#xFF0C;PGID &#x4E5F;&#x662F;&#x5B83;&#x81EA;&#x5DF1;&#x7684; PID&#x3002;</li>
</ul>
</li>
</ul>
<h1 id="Let&#x2019;s-send-a-signal"><a href="#Let&#x2019;s-send-a-signal" class="headerlink" title="Let&#x2019;s send a signal"></a>Let&#x2019;s send a signal</h1><ol>
<li><h2 id="&#x7528;-bin-kill-&#x7A0B;&#x5E8F;&#x53D1;&#x9001;&#x4FE1;&#x53F7;"><a href="#&#x7528;-bin-kill-&#x7A0B;&#x5E8F;&#x53D1;&#x9001;&#x4FE1;&#x53F7;" class="headerlink" title="&#x7528; */bin/kill* &#x7A0B;&#x5E8F;&#x53D1;&#x9001;&#x4FE1;&#x53F7;"></a><strong>&#x7528; */bin/kill* &#x7A0B;&#x5E8F;&#x53D1;&#x9001;&#x4FE1;&#x53F7;</strong></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># &#x53D1;&#x9001;&#x4FE1;&#x53F7; 9 &#xFF08;SIGKILL&#xFF09;&#x7ED9;&#x8FDB;&#x7A0B;&#x7EC4;15213</span><br><span class="line">/bin/kill -9 15213</span><br></pre></td></tr></table></figure>
</li>
<li><h2 id="&#x4ECE;&#x952E;&#x76D8;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;"><a href="#&#x4ECE;&#x952E;&#x76D8;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;" class="headerlink" title="&#x4ECE;&#x952E;&#x76D8;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;"></a>&#x4ECE;&#x952E;&#x76D8;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;</h2><p>&#x901A;&#x8FC7;&#x952E;&#x76D8;&#x8BA9;&#x5185;&#x6838;&#x5411;&#x6BCF;&#x4E2A;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x53D1;&#x9001; SIGINT(SIGTSTP) &#x4FE1;&#x53F7;</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ctrl+C  &#xFF08;SIGINT&#xFF09;   #&#x9ED8;&#x8BA4;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;</span><br><span class="line">Ctrl+Z  &#xFF08;SIGTSTP&#xFF09;  #&#x9ED8;&#x8BA4;&#x6302;&#x8D77;&#x8FDB;&#x7A0B;</span><br></pre></td></tr></table></figure>
</li>
<li><h2 id="&#x7528;-kill-&#x51FD;&#x6570;-https-so-csdn-net-so-search-q-kill-&#x51FD;&#x6570;-spm-1001-2101-3001-7020-&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;"><a href="#&#x7528;-kill-&#x51FD;&#x6570;-https-so-csdn-net-so-search-q-kill-&#x51FD;&#x6570;-spm-1001-2101-3001-7020-&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;" class="headerlink" title="&#x7528;[kill &#x51FD;&#x6570;](https://so.csdn.net/so/search?q=kill &#x51FD;&#x6570;&amp;spm=1001.2101.3001.7020)&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;"></a>&#x7528;[kill &#x51FD;&#x6570;](<a href="https://so.csdn.net/so/search?q=kill">https://so.csdn.net/so/search?q=kill</a> &#x51FD;&#x6570;&amp;spm=1001.2101.3001.7020)&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;</h2></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">	//&#x4F7F;&#x7528;kill&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x53F7;&#x7801; sig &#x7ED9;&#x8FDB;&#x7A0B; pid</span><br><span class="line">int kill(pid_t pid, int sig);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x5982;&#x4E0B;&#x7A0B;&#x5E8F;&#x4E3A; &#x7236;&#x8FDB;&#x7A0B;&#x53D1;&#x9001; SIGKILL &#x4FE1;&#x53F7;&#x7ED9;&#x5B83;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF1A;</span><br><span class="line">int main()</span><br><span class="line">{</span><br><span class="line">    pid_t pid;</span><br><span class="line"></span><br><span class="line">    /* Child sleeps until SIGKILL signal received, then dies */</span><br><span class="line">    if ((pid = fork()) == 0)</span><br><span class="line">	{</span><br><span class="line">		pause();  /* Wait for a signal to arrive */</span><br><span class="line">		printf(&quot;control should never reach here!\n&quot;);</span><br><span class="line">		exit(0);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /* Parent sends a SIGKILL signal to a child */</span><br><span class="line">    kill(pid, SIGKILL);</span><br><span class="line">    exit(0);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Blocking"><a href="#Blocking" class="headerlink" title="Blocking"></a>Blocking</h1><p>Blocking signals means that while a process is handling a particular signal, it won&#x2019;t be <strong>interrupted</strong> by other signals of <strong>the same type.</strong></p>
<p>When a process receives a signal, it may execute a signal handler (a specific function designed to deal with that signal). For example, if it&#x2019;s handling a SIGINT (interrupt signal), it runs the associated function.</p>
<p><strong>Blocking Same Signals</strong>: While this handler is running, any other incoming SIGINT signals are blocked. This means that if another SIGINT arrives, it won&#x2019;t interrupt the current handling process</p>
<p>This prevents confusion and ensures that the process can complete its response to the first signal without being interrupted, maintaining stability and clarity in how signals are processed.</p>
]]></content>
      <tags>
        <tag>计算机组成原理</tag>
        <tag>cs app</tag>
      </tags>
  </entry>
  <entry>
    <title>Process</title>
    <url>/2024/11/02/%E8%BF%9B%E7%A8%8B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      <tags>
        <tag>计算机组成原理</tag>
        <tag>Process</tag>
      </tags>
  </entry>
</search>
